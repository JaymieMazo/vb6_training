-------------------------------EMP1
ALTER TABLE EMP1 ADD JobNum INT 

ALTER TABLE EMP1 ADD PRIMARY KEY (SSN)

ALTER TABLE EMP1 ADD FOREIGN KEY (DNO) REFERENCES DEPARTMENT (dnumber)
ALTER TABLE EMP1 ADD FOREIGN KEY (JobNum) REFERENCES JOBS (JobNum)



INSERT INTO EMP1 (Jobnum)
VALUES (101)
UPDATE EMP1
SET jobnum=10
WHERE ssn=22222

-------------------------------JOBS


CREATE TABLE JOBS
(
JobNum INT,
JobName VARCHAR (20)

PRIMARY KEY (Job num)
)


INSERT INTO JOBS (jobnum, jobname)
VALUES (106 , 'Finance Sprvsr')


DELETE FROM jobs WHERE JobName ='System Analyst'


-----------------------1) VIEWEMP

CREATE VIEW  VIEWEMP AS SELECT FNAME, MINIT,LNAME, SALARY, DNO, EMP1.JOBNUM  FROM EMP1
INNER JOIN JOBS
ON EMP1.JobNum=JOBS.JobNUM



-----------------------2) DEPTSUM
CREATE VIEW  DEPTSUM AS SELECT DEPT.DNAME AS 'DEPARTMENT' ,   SUM(EMP1.SALARY) AS 'SUMSAL' FROM DEPT
INNER JOIN EMP1
ON EMP1.DNO=DEpt.MGRSSN
GROUP BY DEPT.DNAME


-----------------------3) BOSS

CREATE VIEW BOSS AS 
SELECT ssn, emp1.FNAME + ' '  + minit + ' ' + lname AS EMPL_NAME , mgrname AS MANAGER FROM EMP1
INNER JOIN dept
ON EMP1.DNO = dept.MGRSSN

--------------------------------------------------------FOR BOSS TEST_ONLY
CREATE VIEW  BOSS1 AS SELECT EMP1.FNAME + ' ' + EMP1.MINIT + ' ' +  LNAME  AS EmplName, EMP1.SSN AS EmplID, EMP1.SUPERSSN
AS  MANAGER FROM EMP1 
INNER JOIN DEPARTMENT
ON EMP1.DNO=DEPARTMENT.DNUMBER
GROUP BY EMP1.FNAME + ' ' + EMP1.MINIT + ' ' +  LNAME ,EMP1.SSN,  EMP1.SUPERSSN


CREATE VIEW  BOSS AS SELECT EMP1.FNAME + ' ' + EMP1.MINIT + ' ' +  LNAME  AS EmplName, EMP1.SSN AS EmplID, EMP1.SUPERSSN
AS  MANAGER   FROM EMP1 
INNER JOIN DEPARTMENT
ON EMP1.SUPERSSN=DEPARTMENT.MGRSSN
WHERE EMP1.SUPERSSN =EMP1.SSN

SELECT CONVERT(VARCHAR(201), EMP1.SUPERSSN)(SELECT SSN FROM EMP1)
 FROM EMP1 
 
 
 
 SELECT STR(EMPLOYEE.SSN)  + ' ' +  LNAME AS EMPL , EMPLOYEE.SUPERSSN  AS MANAGER FROM EMPLOYEE
 INNER JOIN DEPARTMENT
 ON EMPLOYEE.DNO= DEPARTMENT.DNUMBER
 WHERE SUPERSSN IN (SELECT SSN FROM EMPLOYEE ) 

 
SELECT employee.SSN, EMPLOYEE.fname + ' ' +  EMPLOYEE.lname AS EMPL_NAME, DEPARTMENT.mgrssn AS MANAGER FROM DEPARTMENT
inner JOIN EMPLOYEE
ON DEPARTMENT.MGRSSN =EMPLOYEE.SUPERSSN


 

 --------------------------------4) SALES1

 CREATE VIEW SALES1 AS SELECT  FNAME, MINIT,LNAME,SSN,BDATE,SEX,SUPERSSN,dept.mgrssn  FROM EMP1
 INNER JOIN DEPT
 ON emp1.DNO=DEPT.MGRSSN
 WHERE emp1.DNO=30


 --------------------------------5) SALES2
 CREATE VIEW SALES2 AS SELECT  FNAME, MINIT,LNAME,SSN,BDATE,SEX,SUPERSSN,DEPT.DNAME  FROM EMP1
 INNER JOIN DEPT
 ON emp1.DNO=DEPT.MGRSSN
 WHERE emp1.DNO=30
