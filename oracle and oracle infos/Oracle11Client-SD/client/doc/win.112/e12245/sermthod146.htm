<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:57Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod145.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod147.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>Read (OraLOB/BFILE) Method</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod145.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod147.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="CIHDFFEH" name="CIHDFFEH"></a><a id="OOFOL615" name="OOFOL615"></a>
<hr />
<div class="refsect1">
<h1 class="refsect1">Read (OraLOB/BFILE) Method</h1>
<a id="sthref1469" name="sthref1469"></a>
<p class="titleinrefsubsect">Applies To</p>
<p><a href="serobjch006.htm#BABHEIGC">OraBLOB, OraCLOB Objects</a></p>
<p><a href="serobjch005.htm#BABEIJFF">OraBFILE Object</a></p>
<a id="sthref1470" name="sthref1470"></a>
<p class="titleinrefsubsect">Description</p>
<p>Reads into a buffer a specified portion of a <code>BLOB</code>, <code>CLOB</code>, or <code>BFILE</code> value. Returns the total amount of data read.</p>
<a id="sthref1471" name="sthref1471"></a>
<p class="titleinrefsubsect">Usage</p>
<pre xml:space="preserve" class="oac_no_warn"><span class="italic">amount_read</span> = OraBlob.Read <span class="italic">buffer</span>, <span class="italic">chunksize</span>
<span class="italic">amount_read</span> = OraClob.Read <span class="italic">buffer</span>, <span class="italic">chunksize</span>
<span class="italic">amount_read</span> = OraBfile.Read <span class="italic">buffer</span>, <span class="italic">chunksize</span>
</pre>
<a id="sthref1472" name="sthref1472"></a>
<p class="titleinrefsubsect">Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="Informal" title="Read (OraLOB/BFILE) method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="25%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t184">Arguments</th>
<th align="left" valign="bottom" id="r1c2-t184">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t184" headers="r1c1-t184">[<code>out</code>] <code><span class="codeinlineitalic">buffer</span></code></td>
<td align="left" headers="r2c1-t184 r1c2-t184"><code>Variant</code> of type character array for <code>OraCLOB</code>, <code>Variant</code> of type byte array for <code>OraBLOB</code>, or <code>OraBFILE</code> from which the piece is read.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t184" headers="r1c1-t184">[<code>in</code>] [optional] <code><span class="codeinlineitalic">chunksize</span></code></td>
<td align="left" headers="r3c1-t184 r1c2-t184">An <code>Integer</code> specifying the amount to be read. Default value is the size of the LOB. In bytes for <code>OraBLOB</code> or <code>OraBFILE</code>; characters for <code>OraCLOB</code>.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t184" headers="r1c1-t184">[<code>out</code>] <code><span class="codeinlineitalic">amount_read</span></code></td>
<td align="left" headers="r4c1-t184 r1c2-t184">An <code>Integer</code> representing the total amount of data read. In bytes for <code>OraBLOB</code> or <code>OraBFILE</code>; characters for <code>OraCLOB</code>.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="sthref1473" name="sthref1473"></a>
<p class="titleinrefsubsect">Remarks</p>
<p>Reads the LOB or <code>BFILE</code> data from the offset specified by the <code>Offset</code> property. For multiple piece read operation, the <code>PollingAmount</code> property must be set to the value of the total amount of data to be read, and the <code>Status</code> property must be checked for the success of each piece operation.</p>
<div class="infoboxnote">
<p class="notep1"><span class="bold">Note</span>:</p>
When reading a portion of a LOB, it is recommended that you set the <code>PollingAmount</code> property, rather than using the <code><span class="codeinlineitalic">chunksize</span></code> parameter. This avoids the possibility of raising an error if the entire LOB is not read before to executing another LOB method.</div>
<a id="sthref1474" name="sthref1474"></a>
<p class="titleinrefsubsect">Examples</p>
<p>Be sure that you have installed the OraLOB Schema Objects as described in <a href="appendix.htm#BABJGBAG">"Schema Objects Used in LOB Data Type Examples"</a> .</p>
<a id="OOFOL616" name="OOFOL616"></a><a id="BHBIECAI" name="BHBIECAI"></a>
<p class="subhead2">Example: Multiple-Piece Read of a LOB</p>
<pre xml:space="preserve" class="oac_no_warn">Dim OraSession As OraSession 
Dim OraDatabase As OraDatabase 
Dim OraDynaset As OraDynaset 
Dim PartImage As OraBlob 
Dim chunksize As Long 
Dim AmountRead As Long 
Dim buffer As Variant 
Dim buf As String 
 
'Create the OraSession Object. 
Set OraSession = CreateObject("OracleInProcServer.XOraSession") 
 
'Create the OraDatabase Object by opening a connection to Oracle. 
Set OraDatabase = OraSession.OpenDatabase("ExampleDb","scott/tiger", 0&amp;)  
 
'Create the OraDynaset Object. 
Set OraDynaset = OraDatabase.CreateDynaset("select * from part", 0&amp;) 
 
'Get OraBlob from OraDynaset 
Set PartImage = OraDynaset.Fields("part_image").Value 
 
'Set Offset and PollingAmount property for piecewise Read operation 
PartImage.offset = 1 
PartImage.PollingAmount = PartImage.Size 
chunksize = 50000 
 
'Get a free file number 
FNum = FreeFile 
 
'Open the file 
Open "image.dat" For Binary As #FNum 
 
'Do the first read on PartImage, buffer must be a variant 
AmountRead = PartImage.Read(buffer, chunksize) 
 
'put will not allow Variant type 
buf = buffer 
Put #FNum, , buf 
 
' Check for the Status property for polling read operation 
While PartImage.Status = ORALOB_NEED_DATA 
    AmountRead = PartImage.Read(buffer, chunksize) 
    buf = buffer 
    Put #FNum, , buf 
Wend 
 
Close FNum 
</pre>
<a id="OOFOL617" name="OOFOL617"></a><a id="BHBCAFBH" name="BHBCAFBH"></a>
<p class="subhead2">Example: Single-Piece Read of a LOB</p>
<pre xml:space="preserve" class="oac_no_warn">Dim OraSession As OraSession 
Dim OraDatabase As OraDatabase 
Dim PartDesc As OraClob 
Dim AmountRead As Long 
Dim buffer As Variant 
Dim buf As String 
 
'Create the OraSession Object. 
Set OraSession = CreateObject("OracleInProcServer.XOraSession") 
 
'Create the OraDatabase Object. 
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
'Add PartDesc as an Output parameter and set its initial value. 
OraDatabase.Parameters.Add "PartDesc", Null, ORAPARM_OUTPUT 
OraDatabase.Parameters("PartDesc").ServerType = ORATYPE_CLOB 
 
'Execute the statement returning 'PartDesc' 
OraDatabase.ExecuteSQL ("BEGIN select part_desc into :PARTDESC from" &amp; _ 
             "part where part_id = 1 for update NOWAIT; END;") 
 
'Get 'PartDesc' from Parameters collection 
Set PartDesc = OraDatabase.Parameters("PartDesc").Value 
 
'Get a free file number 
FNum = FreeFile 
 
'Open the file. 
 
Open "Desc.Dat" For Binary As #FNum 
 
'Read entire CLOB value, buffer must be a Variant 
AmountRead = PartDesc.Read(buffer) 
 
'put will not allow Variant type 
buf = buffer 
Put #FNum, , buf 
 
Close FNum 
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="serprop093.htm#CEGFGAAJ">Offset (OraLOB/BFILE) Property</a></p>
</li>
<li>
<p><a href="serprop104.htm#CHDFIBDJ">PollingAmount Property</a></p>
</li>
<li>
<p><a href="serprop125.htm#CEGCGCEC">Status (OraLOB/BFILE) Property</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod145.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod147.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
