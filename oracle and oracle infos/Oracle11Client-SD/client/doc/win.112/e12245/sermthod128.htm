<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:56Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod127.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod129.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>MonitorForFailover Method</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod127.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod129.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="CIHBAHEJ" name="CIHBAHEJ"></a><a id="OOFOL591" name="OOFOL591"></a>
<hr />
<div class="refsect1">
<h1 class="refsect1">MonitorForFailover Method</h1>
<a id="sthref1380" name="sthref1380"></a>
<p class="titleinrefsubsect">Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
<a id="sthref1381" name="sthref1381"></a>
<p class="titleinrefsubsect">Description</p>
<p>Registers the failover notification handler of the application.</p>
<a id="sthref1382" name="sthref1382"></a>
<p class="titleinrefsubsect">Usage</p>
<pre xml:space="preserve" class="oac_no_warn">OraDatabase.MonitorForFailover <span class="italic">FOSink</span>, <span class="italic">FOCtx</span>
</pre>
<a id="sthref1383" name="sthref1383"></a>
<p class="titleinrefsubsect">Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="Informal" title="MonitorForFailover method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="25%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t165">Arguments</th>
<th align="left" valign="bottom" id="r1c2-t165">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t165" headers="r1c1-t165">[<code>in</code>] <code><span class="codeinlineitalic">FOSink</span></code></td>
<td align="left" headers="r2c1-t165 r1c2-t165">An <code>IDispatch</code> interface implementing the <code>OnFailover</code> method which is notified in event of a failover.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t165" headers="r1c1-t165">[<code>in</code>] <code><span class="codeinlineitalic">FOCtx</span></code></td>
<td align="left" headers="r3c1-t165 r1c2-t165">Context-specific information that the application wants passed into the <code>OnFailover</code> method in the event of a failover.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="sthref1384" name="sthref1384"></a>
<p class="titleinrefsubsect">Remarks</p>
<p>To receive failover notifications, a notification handler must be registered with the <code>MonitorForFailover</code> method. The notification handler must be an automation object (a class module in Visual Basic) that implements the <code>OnFailover</code> method.</p>
<p>The syntax of the method is:</p>
<pre xml:space="preserve" class="oac_no_warn">Public Function OnFailover(Ctx As Variant, fo_type As Variant,fo_event as Variant, fo_OraDB as Variant) 
</pre>
<div class="inftblinformal">
<table class="Informal" title="MonitorForFailover Method Syntax parameters" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="26%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t166">Variants</th>
<th align="left" valign="bottom" id="r1c2-t166">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t166" headers="r1c1-t166"><code>[in]</code> <code>Ctx</code></td>
<td align="left" headers="r2c1-t166 r1c2-t166">Passed into the <code>MonitorForFailover</code> method by the application. Context-sensitive information that the application wants passed in event of a failover.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t166" headers="r1c1-t166"><code>[in]</code> <code>fo_type</code></td>
<td align="left" headers="r3c1-t166 r1c2-t166"><code>Failover</code> type. This is the type of failover that the client has requested. The values are:
<ul>
<li>
<p><code>OO4O_FO_SESSION</code> indicates only session failover requested.</p>
</li>
<li>
<p><code>OO4O_FO_SELECT</code> indicates select failover and session failover requested.</p>
</li>
</ul>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t166" headers="r1c1-t166"><code>[in]</code>
<p><code>fo_event</code></p>
</td>
<td align="left" headers="r4c1-t166 r1c2-t166"><code>Failover</code> event. This indicates the state of the failover. It has several possible values:
<ul>
<li>
<p><code>OO4O_FO_BEGIN</code> indicates that failover has detected a lost connection and failover is starting.</p>
</li>
<li>
<p><code>OO4O_FO_END</code> indicates successful completion of a failover.</p>
</li>
<li>
<p><code>OO4O_FO_ABORT</code> indicates that a failover was unsuccessful, and there is no option of retrying.</p>
</li>
<li>
<p><code>OO4O_FO_ERROR</code> indicates that a failover was unsuccessful, and gives the application the opportunity to handle the error and retry the failover. The application can retry the failover, by programming the <code>OnFailover</code> method to return <code>OO4O_FO_RETRY</code>.</p>
</li>
<li>
<p><code>OO4O_FO_REAUTH</code> indicates that a user handle has been reauthenticated. This applies to the situation where a client has multiple user sessions on a single database connection. During the initial failover, only the active user session is failed over. Other sessions are failed over when the application tries to use them. This is the value passed to the callback during these subsequent failovers.</p>
</li>
</ul>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r5c1-t166" headers="r1c1-t166"><code>[in]</code> <code>fo_OraDB</code></td>
<td align="left" headers="r5c1-t166 r1c2-t166">The <code>OraDatabase</code> object of the user session that is being failed over. Valid only when the <code>fo_event</code> variant is <code>OO4O_FO_REAUTH</code>.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="sthref1385" name="sthref1385"></a>
<p class="titleinrefsubsect">Examples</p>
<a id="OOFOL592" name="OOFOL592"></a>
<p class="subhead2">Failover Notification Example</p>
<p>See <a href="advfeat.htm#BABHEHBB">Example: Failover Notification</a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="advfeat.htm#CIHGBCIA">"Application Failover Notifications"</a></div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod127.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod129.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
