<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:46Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="intro.htm" title="Previous" type="text/html" />
<link rel="Next" href="basfeat.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>Using Oracle Objects for OLE with Automation Clients</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="intro.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="basfeat.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="BABFBBGD" name="BABFBBGD"></a><a id="OOFOL0002" name="OOFOL0002"></a>
<h1 class="chapter"><span class="secnum">2</span> Using Oracle Objects for OLE with Automation Clients</h1>
<p>This chapter describes the use of automation clients to access Oracle data.</p>
<p>This chapter contains these topics:</p>
<ul>
<li>
<p><a href="#CIHDGCHB">Using Automation Clients Overview</a></p>
</li>
<li>
<p><a href="#CIHFAFDD">Demonstration Schema and Code Examples</a></p>
</li>
<li>
<p><a href="#CIHBHJDF">Using Oracle Objects for OLE Automation with Visual Basic</a></p>
</li>
<li>
<p><a href="#CIHJBJDC">Using OO4O Automation with Active Server Pages (ASP)</a></p>
</li>
<li>
<p><a href="#CIHFAHJJ">Using Oracle Objects for OLE Automation with Excel</a></p>
</li>
<li>
<p><a href="#CIHICFJB">Using Microsoft C++</a></p>
</li>
<li>
<p><a href="#CIHFFIII">Using Oracle Data Control with Visual Basic</a></p>
</li>
<li>
<p><a href="#CIHHECIH">Using the Oracle Data Control with MS Visual C++</a></p>
</li>
</ul>
<a id="CIHDGCHB" name="CIHDGCHB"></a><a id="OOFOL128" name="OOFOL128"></a>
<div class="sect1">
<h2 class="sect1">Using Automation Clients Overview<a id="sthref74" name="sthref74"></a><a id="sthref75" name="sthref75"></a><a id="sthref76" name="sthref76"></a><a id="sthref77" name="sthref77"></a><a id="sthref78" name="sthref78"></a><a id="sthref79" name="sthref79"></a><a id="sthref80" name="sthref80"></a></h2>
<p>Oracle Objects for OLE (OO4O) is designed to provide quick and efficient access to the data in an Oracle database using various programming or scripting languages.</p>
<p>OO4O can be easily used with Visual Basic, Excel, Active Server Pages, Internet Information Server (IIS), and other development tools.</p>
<p>Oracle Data Control with Visual Basic allows another method of accessing Oracle data.</p>
<p>Examples are provided for specific methods and properties in this developer's guide. Additionally, example programs are installed with Oracle Objects for OLE and are located in the <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o\</code> directory under VB, EXCEL, IIS, CPP, and so on.</p>
<p>A Quick Tour of OO4O with Visual Basic is also provided.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="quicktour.htm#CCHCCJDC">Chapter 6, "Quick Tour with Visual Basic"</a></div>
</div>
<!-- class="sect1" -->
<a id="CIHFAFDD" name="CIHFAFDD"></a><a id="OOFOL129" name="OOFOL129"></a>
<div class="sect1">
<h2 class="sect1">Demonstration Schema and Code Examples<a id="sthref81" name="sthref81"></a><a id="sthref82" name="sthref82"></a><a id="sthref83" name="sthref83"></a></h2>
<p>The code examples included in this developer's guide and the example applications shipped with Oracle Objects for OLE are designed to work with a demonstration schema (database tables and other objects) and a demonstration user and password, <code>scott</code>/<code>tiger</code>. Code examples are located in the <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o</code> directory.</p>
<a id="OOFOL130" name="OOFOL130"></a>
<div class="sect2"><a id="sthref84" name="sthref84"></a>
<h3 class="sect2">Demonstration Schema Creation<a id="sthref85" name="sthref85"></a><a id="sthref86" name="sthref86"></a><a id="sthref87" name="sthref87"></a><a id="sthref88" name="sthref88"></a><a id="sthref89" name="sthref89"></a><a id="sthref90" name="sthref90"></a><a id="sthref91" name="sthref91"></a><a id="sthref92" name="sthref92"></a><a id="sthref93" name="sthref93"></a><a id="sthref94" name="sthref94"></a><a id="sthref95" name="sthref95"></a><a id="sthref96" name="sthref96"></a> <a id="sthref97" name="sthref97"></a></h3>
<p>You can create the OO4O demonstration schema with the <code>demobld7.sql</code> script located in the <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o</code> directory. You can drop the demonstration schema with the <code>demodrp7.sql</code> script.</p>
<a id="OOFOL131" name="OOFOL131"></a>
<div class="sect3"><a id="sthref98" name="sthref98"></a>
<h4 class="sect3">Demonstration Schema</h4>
<p>The demonstration schema includes the following references:</p>
<ul>
<li>
<p>Demonstration tables <code>EMP</code> and <code>DEPT</code>.</p>
</li>
<li>
<p>The user <code>scott</code> with password <code>tiger</code> (<code>scott</code>/<code>tiger</code>).</p>
</li>
<li>
<p>The network alias, <code><span class="codeinlineitalic">ExampleDb</span></code>.</p>
<p>Refer to <a class="olink NETAG" href="http://www.oracle.com/pls/db102/lookup?id=NETAG"><span class="italic">Oracle Net Services Administrator's Guide</span></a> for assistance in setting up the network service (database) alias and the <code>tnsnames.ora</code> file.</p>
<p>In many of the examples, you can access a local database using <code>"</code> <code>"</code> (a null string) for the network alias.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<a id="OOFOL132" name="OOFOL132"></a>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref99" name="sthref99"></a>
<h4 class="sect3">Other Schemas</h4>
<p>Occasionally other schemas are required to run examples. The introductions to the examples contain names and locations of the schemas (in the appendix).</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="appendix.htm#BEHGHBCJ">"Additional Schemas"</a></div>
</div>
<!-- class="sect3" -->
<a id="OOFOL133" name="OOFOL133"></a>
<div class="sect3"><a id="sthref100" name="sthref100"></a>
<h4 class="sect3">Related Files<a id="sthref101" name="sthref101"></a><a id="sthref102" name="sthref102"></a><a id="sthref103" name="sthref103"></a><a id="sthref104" name="sthref104"></a><a id="sthref105" name="sthref105"></a><a id="sthref106" name="sthref106"></a><a id="sthref107" name="sthref107"></a><a id="sthref108" name="sthref108"></a></h4>
<p>The <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o</code> directory contains the following items:</p>
<ul>
<li>
<p>OO4O example programs.</p>
<p>Subdirectories contain both C++ and Visual Basic examples.</p>
</li>
<li>
<p>The <code>oraexamp.sql</code> script, used to create stored procedures. Additional scripts, such as <code>multicur.sql</code> and <code>empcur.sql</code>, are provided to set up other example programs.</p>
</li>
<li>
<p>Oracle Objects for OLE global constant file, <code>oraconst.txt</code>, which contains constant values used for option flags and property values. This file is usually not needed as these constants are also included with the Oracle In-Process Server type library.</p>
</li>
</ul>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHBHJDF" name="CIHBHJDF"></a><a id="OOFOL134" name="OOFOL134"></a>
<div class="sect1"><a id="BABCGGHA" name="BABCGGHA"></a>
<h2 class="sect1">Using Oracle Objects for OLE Automation with Visual Basic<a id="sthref109" name="sthref109"></a><a id="sthref110" name="sthref110"></a><a id="sthref111" name="sthref111"></a><a id="sthref112" name="sthref112"></a></h2>
<p>This example contains code fragments that demonstrate how to create all objects required by a dynaset and then create the dynaset itself.</p>
<ol>
<li>
<p>Start Visual Basic and create a new project. From the <span class="bold">Project</span> menu, select <span class="bold">References</span> and check <span class="bold">InProcServer 5.0 Type Library</span>.</p>
<img width="449" height="356" src="img/o4o00003.gif" alt="References dialog box OIP Server 5.0 Type library checked" title="References dialog box OIP Server 5.0 Type library checked" longdesc="img_text/o4o00003.htm" /><br />
<a id="sthref113" name="sthref113" href="img_text/o4o00003.htm">Description of the illustration o4o00003.gif</a><br />
<br /></li>
<li>
<p>Start Visual Basic and create a new project. Then, add the following code to the Declarations section of a form:</p>
<pre xml:space="preserve" class="oac_no_warn">... 
' Declare variables 
Dim OraSession As OraSession 
Dim OraDatabase As OraDatabase 
Dim OraDynaset As OraDynaset 
Dim OraFields As OraFields
</pre></li>
<li>
<p>Add the following code to the load procedure associated with the form to display the Oracle data:</p>
<pre xml:space="preserve" class="oac_no_warn">' Create the OraSession Object. The argument to CreateObject is the 
' name by which the OraSession object is known to the OLE system. 
Set OraSession = CreateObject("OracleInProcServer.XOraSession") 
 
' Create the OraDatabase Object by opening a connection to Oracle.
Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;) 
 
' Create the OraDynaset Object. 
Set OraDynaset = OraDatabase.CreateDynaset("select * from emp", 0&amp;) 
 
' You can now display or manipulate the data in the dynaset. For example: 
Set OraFields = OraDynaset.fields 
OraDynaset.movefirst 
Do While Not OraDynaset.EOF 
MsgBox OraFields("ename").Value 
OraDynaset.movenext 
Loop 
End Sub 
</pre></li>
<li>
<p>Run the form to view the results.</p>
</li>
</ol>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="#BABFBBGD">"Using Oracle Objects for OLE with Automation Clients"</a> for more information about using OO4O with Visual Basic</p>
</li>
<li>
<p><a href="serobjch007.htm#BABIEBCH">OraClient Object</a></p>
</li>
<li>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
</li>
<li>
<p><a href="serobjch011.htm#BABJBBAI">OraDynaset Object</a></p>
</li>
<li>
<p><a href="serobjch012.htm#BABHHJGE">OraField Object</a></p>
</li>
<li>
<p><a href="serobjch020.htm#BABDIJAH">OraParameter Object</a></p>
</li>
<li>
<p><a href="serobjch023.htm#BABFCBJH">OraSession Object</a></p>
</li>
</ul>
</div>
</div>
<!-- class="sect1" -->
<a id="CIHJBJDC" name="CIHJBJDC"></a><a id="OOFOL135" name="OOFOL135"></a>
<div class="sect1">
<h2 class="sect1">Using OO4O Automation with Active Server Pages (ASP)<a id="sthref114" name="sthref114"></a><a id="sthref115" name="sthref115"></a><a id="sthref116" name="sthref116"></a><a id="sthref117" name="sthref117"></a><a id="sthref118" name="sthref118"></a><a id="sthref119" name="sthref119"></a><a id="sthref120" name="sthref120"></a><a id="sthref121" name="sthref121"></a><a id="sthref122" name="sthref122"></a></h2>
<p>This example uses Active Server Pages (ASP) in a Microsoft Internet Information Server (IIS) to demonstrate the connection pooling feature of Oracle Objects for OLE. The sample code executes a SQL <code>SELECT</code> query and returns the result as an HTML table. The database connection used in this script is obtained from a pool that is created when the <code>global.asa</code> file is executed.</p>
<p><a id="sthref123" name="sthref123"></a>To use Oracle Objects for OLE with OLE Automation and IIS, you need to install IIS 3.0 or later, including all ASP extensions. On the computer where IIS is running, an Oracle database must also be accessible.</p>
<div class="infoboxnote">
<p class="notep1">Note:</p>
The sample code for this example is available in the <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o\iis\samples\asp\connpool</code> directory.</div>
<ol>
<li>
<p>Start SQL*Plus and log in to the Oracle database as <code>scott</code>/<code>tiger</code>.</p>
<p>Create the following PL/SQL procedures:</p>
<pre xml:space="preserve" class="oac_no_warn">-- creates PL/SQL package to be used in ASP demos
create or replace package ASP_demo as 
    --cursor c1 is select * from emp; 
    type empCur is ref cursor; 
PROCEDURE GetCursor(p_cursor1 in out empCur, indeptno IN NUMBER, 
                  p_errorcode OUT NUMBER); 
END ASP_demo;
/
</pre>
<p>Create or replace the ASP_demo package body as follows:</p>
<pre xml:space="preserve" class="oac_no_warn">PROCEDURE GetCursor(p_cursor1 in out empCur, indeptno IN NUMBER, 
                 p_errorcode OUT NUMBER) is 
BEGIN 
    p_errorcode:= 0; 
    open p_cursor1 for select * from emp where deptno = indeptno; 
EXCEPTION 
    When others then 
    p_errorcode:= SQLCODE; 
END GetCursor; 
...
</pre>
<pre xml:space="preserve" class="oac_no_warn">END ASP_demo; 
/
 
</pre></li>
<li>
<p>Create the Active Server Pages (ASP) sample code. The OO4O related code is in <span class="bold">bold</span>.</p>
<pre xml:space="preserve" class="oac_no_warn">'GLOBAL.ASA 

<span class="bold">&lt;OBJECT RUNAT=Server SCOPE=Application ID=OraSession </span>
              P<span class="bold">ROGID="OracleInProcServer.XOraSession"&gt;&lt;/OBJECT&gt; </span>
<span class="bold">&lt;SCRIPT LANGUAGE=VBScript RUNAT=Server&gt; </span>
<span class="bold">Sub Application_OnStart</span> 
 
<span class="bold">'Get an instance of the Connection Pooling object and </span>
<span class="bold">'create a pool of OraDatabase</span> 
<span class="bold">OraSession.CreateDatabasePool</span> 1,<span class="bold">40</span>,<span class="bold">200</span>,"<span class="bold">exampledb</span>", "<span class="bold">scott/tiger</span>",  <span class="bold">0</span> 
<span class="bold">End Sub</span> 
 
'OO4ODEMO.ASP 

&lt;html&gt; 
&lt;head&gt; 
&lt;title&gt;Oracle Objects For OLE (OO4O) &lt;/title&gt; 
&lt;/head&gt; 
&lt;body BGCOLOR="#FFFFFF"&gt; 
&lt;font FACE="ARIAL,HELVETICA"&gt; 
&lt;h2 align="center"&gt;Oracle Objects For OLE (OO4O) &lt;/h2&gt; 
&lt;form ACTION="OO4ODEMO.asp" METHOD="POST"&gt; 
&lt;% 
SqlQuery = Request.Form("sqlquery") 
%&gt; 
&lt;p&gt;This sample executes a SQL SELECT query and returns the result as an HTML table. The database connection used in this script is obtained from a pool that is created when the &lt;strong&gt;global.asa&lt;/strong&gt; is executed. &lt;/p&gt; 
&lt;p&gt;SQL Select Query: &lt;input SIZE="48" NAME="sqlquery"&gt; &lt;/p&gt; 
&lt;p&gt;&lt;input TYPE="SUBMIT"&gt; &lt;input TYPE="RESET"&gt; &lt;input LANGUAGE="VBScript" TYPE="button" VALUE="Show ASP Source" ONCLICK="Window.location.href = &amp;quot;oo4oasp.htm&amp;quot;" 
 
NAME="ShowSrc"&gt;&lt;/p&gt; 
&lt;/form&gt; 
&lt;% 
If SqlQuery = "" Then 
%&gt; 
&lt;% Else %&gt; 
&lt;table BORDER="1"&gt; 
&lt;% 
<span class="bold">Set</span> <span class="bold">OraDatabase</span> = <span class="bold">OraSession.GetDatabaseFromPool(10</span>) 
<span class="bold">Set</span> <span class="bold">OraDynaset</span> = <span class="bold">OraDatabase.CreateDynaset(SqlQuery,0)</span> 
<span class="bold">Set</span> <span class="bold">Columns</span> = <span class="bold">OraDynaset.Fields</span> 
%&gt; 
&lt;tr&gt; 
&lt;td&gt;&lt;table BORDER="1"&gt; 
&lt;tr&gt; 
<span class="bold">&lt;% </span><span class="bold">For i = 0 to</span> <span class="bold">Columns.Count</span><span class="bold"> - 1 </span><span class="bold">%&gt;</span> 
<span class="bold">&lt;td&gt;&lt;b&gt;&lt;% = Columns(i).Name %&gt;&lt;/b&gt;&lt;/td&gt;</span> 
<span class="bold">&lt;% Next %&gt; </span>
&lt;/tr&gt; 
<span class="bold">&lt;% while NOT OraDynaset.EOF %&gt; </span>
&lt;tr&gt; 
<span class="bold">&lt;% For col = 0 to Columns.Count - 1 %&gt;</span> 
&lt;td&gt;<span class="bold">&lt;% = Columns(col) %&gt;</span> 
&lt;/td&gt; 
<span class="bold">&lt;% Next %&gt; </span>
&lt;/tr&gt; 
<span class="bold">&lt;% OraDynaset.MoveNext %&gt; </span>
<span class="bold">&lt;% WEnd %&gt;</span> 
&lt;/table&gt; 
 
&lt;p&gt;&lt;/font&gt;<span class="bold">&lt;%End If%&gt;</span> &lt;/p&gt; 
&lt;hr&gt; 
&lt;/td&gt; 
&lt;/tr&gt; 
&lt;/table&gt; 
&lt;/body&gt; 
&lt;/html&gt;
 
</pre></li>
<li>
<p>Create a virtual directory from Microsoft Internet Service Manager with read and execute access, and place all <code>.asp</code> and <code>.asa</code> files in that directory.</p>
</li>
<li>
<p>Create an HTML page from which to launch the <code>oo4odemo.asp</code> file. Add a link in the page as follows:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;a href="/&lt;<span class="italic">your_path</span>&gt;/OO4ODEMO.ASP"&gt;This link launches the demo!&lt;/a&gt;
</pre></li>
<li>
<p>Load the page in a web browser and click the link to the demonstration.</p>
</li>
<li>
<p>Enter a query, such as <code>'SELECT * FROM EMP'</code>, in the <span class="bold">SQL SELECT Query</span> field, and select the <span class="bold">Submit Query</span> button. Do not include a semicolon (<code>;)</code> at the end of the query.</p>
<img width="560" height="353" src="img/iissamp.gif" alt="SQL Select Query field with the entry select * from emp." title="SQL Select Query field with the entry select * from emp." longdesc="img_text/iissamp.htm" /><br />
<a id="sthref124" name="sthref124" href="img_text/iissamp.htm">Description of the illustration iissamp.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CIHFAHJJ" name="CIHFAHJJ"></a><a id="OOFOL136" name="OOFOL136"></a>
<div class="sect1">
<h2 class="sect1">Using Oracle Objects for OLE Automation with Excel<a id="sthref125" name="sthref125"></a><a id="sthref126" name="sthref126"></a><a id="sthref127" name="sthref127"></a><a id="sthref128" name="sthref128"></a></h2>
<p>This sample shows how to insert Oracle data into an Excel worksheet.</p>
<div class="infoboxnote">
<p class="notep1">Note:</p>
The sample code for this example is available in the <code><span class="codeinlineitalic">ORACLE_BASE\\ORACLE_HOME</span></code><code>\oo4o\excel\samples\</code> directory.</div>
<p>To use OLE Automation with Microsoft Excel to insert Oracle data into a worksheet, perform the following steps:</p>
<ol>
<li>
<p>Start Excel and create a new worksheet.</p>
</li>
<li>
<p>Use the <span class="bold">Macro</span> options in the <span class="bold">Tools</span> menu to create and edit new macros for manipulating the Oracle data.</p>
<img width="404" height="310" src="img/exmacros.gif" alt="A dialog box with a list of possible macros." title="A dialog box with a list of possible macros." longdesc="img_text/exmacros.htm" /><br />
<a id="sthref129" name="sthref129" href="img_text/exmacros.htm">Description of the illustration exmacros.gif</a><br />
<br /></li>
<li>
<p>Enter Visual Basic code for macros to create and access an Oracle dynaset, such as the following <code>EmpData()</code> and <code>ClearData()</code> procedures (macros):</p>
<pre xml:space="preserve" class="oac_no_warn">Sub EmpData() 
 
'Declare variables 
Dim OraSession As OraSession 
Dim OraDatabase As OraDatabase 
Dim EmpDynaset As OraDynaset 
Dim flds() As OraField 
Dim fldcount As Integer 
  Set OraSession = CreateObject("OracleInProcServer.XOraSession") 
  Set OraDatabase = OraSession.OpenDatabase("ExampleDB", "scott/tiger", 0&amp;)  
  Set EmpDynaset = OraDatabase.CreateDynaset("select * from emp", 0&amp;) 
  Range("A1:H15").Select 
  Selection.ClearContents 
 
   'Declare and create an object for each column. 
   'This will reduce objects references and speed up your application.  
fldcount = EmpDynaset.Fields.Count 
ReDim flds(0 To fldcount - 1) 
For Colnum = 0 To fldcount - 1 
  Set flds(Colnum) = EmpDynaset.Fields(Colnum) 
Next 
 
'Insert Column Headings 
For Colnum = 0 To EmpDynaset.Fields.Count - 1 
  ActiveSheet.Cells(1, Colnum + 1) = flds(Colnum).Name 
Next 
 
'Display Data 
For Rownum = 2 To EmpDynaset.RecordCount + 1 
  For Colnum = 0 To fldcount - 1 
    ActiveSheet.Cells(Rownum, Colnum + 1) = flds(Colnum).Value 
  Next 
  EmpDynaset.MoveNext 
Next 

Range("A1:A1").Select
 
End Sub 

Sub ClearData() 
  Range("A1:H15").Select 
  Selection.ClearContents 
  Range("A1:A1").Select 
End Sub 
</pre></li>
<li>
<p>Assign the procedures (macros) that were created, such as <code>EmpData()</code> and <code>ClearData()</code>, to command buttons in the worksheet for easy access. When you select the buttons, you can clear and refresh the data in the worksheet. In the following screenshot, <code>ClearData()</code> is assigned to the Clear button and <code>EmpData()</code> is assigned to the Refresh button.</p>
<img width="572" height="346" src="img/exsheet.gif" alt="a spreadsheet, with sample data for empno, ename, job etc" title="a spreadsheet, with sample data for empno, ename, job etc" longdesc="img_text/exsheet.htm" /><br />
<a id="sthref130" name="sthref130" href="img_text/exsheet.htm">Description of the illustration exsheet.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect1" -->
<a id="CIHICFJB" name="CIHICFJB"></a><a id="OOFOL137" name="OOFOL137"></a>
<div class="sect1">
<h2 class="sect1">Using Microsoft C++<a id="sthref131" name="sthref131"></a><a id="sthref132" name="sthref132"></a></h2>
<p>For details about Oracle Objects for OLE with Visual C++, see <span class="italic">Oracle Objects for OLE C++ Class Library Developer's Guide</span>, available as online help.</p>
</div>
<!-- class="sect1" -->
<a id="CIHFFIII" name="CIHFFIII"></a><a id="OOFOL138" name="OOFOL138"></a>
<div class="sect1">
<h2 class="sect1">Using Oracle Data Control with Visual Basic<a id="sthref133" name="sthref133"></a><a id="sthref134" name="sthref134"></a><a id="sthref135" name="sthref135"></a><a id="sthref136" name="sthref136"></a></h2>
<p>Oracle Data Control, when refreshed, automatically creates a client (if needed), session, database, and dynaset. For a basic application, little or no code is required.</p>
<p>This section shows two ways to set the properties of Oracle Data Control:</p>
<ul>
<li>
<p>Using the Visual Basic Properties window</p>
</li>
<li>
<p>Programming the properties</p>
</li>
</ul>
<a id="BABBBGIC" name="BABBBGIC"></a><a id="OOFOL139" name="OOFOL139"></a>
<div class="sect2">
<h3 class="sect2">Setting Oracle Data Control Properties with the Properties Window</h3>
<ol>
<li>
<p>Start Visual Basic and create a new project.</p>
</li>
<li>
<p>In the <span class="bold">Components</span> option of the <span class="bold">Project</span> menu, add <span class="bold">Oracle Data Control</span> to the project.</p>
<img width="455" height="404" src="img/o4o00004.gif" alt="the Components option of the Project menu" title="the Components option of the Project menu" longdesc="img_text/o4o00004.htm" /><br />
<a id="sthref137" name="sthref137" href="img_text/o4o00004.htm">Description of the illustration o4o00004.gif</a><br />
<br />
<p>The Oracle Data Control is added to your Visual Basic tool palette and looks like this:</p>
<img width="61" height="61" src="img/oradc.gif" alt="Components option of the Project menu" title="Components option of the Project menu" longdesc="img_text/oradc.htm" /><br />
<a id="sthref138" name="sthref138" href="img_text/oradc.htm">Description of the illustration oradc.gif</a><br />
<br /></li>
<li>
<p>To add Oracle Data Control to a project, drag and drop the control onto a form. Resize and position the control.</p>
</li>
<li>
<p>Change the name of the control to <code>OraDataControl</code>. Set up the <code>Connect</code>, <code>DatabaseName</code>, and <code>RecordSource</code> properties as follows to access the Oracle database:</p>
<img width="277" height="390" src="img/dcprops.gif" alt="Properties window" title="Properties window" longdesc="img_text/dcprops.htm" /><br />
<a id="sthref139" name="sthref139" href="img_text/dcprops.htm">Description of the illustration dcprops.gif</a><br />
<br /></li>
<li>
<p>When Oracle Data Control is set up, you can drag and drop a Visual Basic control onto the same form and access the data in the control. Set the <span class="bold">Data</span> properties to access the data field and source that you want. The following figure shows a TextBox control that sets up display of the employee numbers.</p>
<img width="277" height="275" src="img/boxprops.gif" alt="TextBox control that sets up display of the employee numbers" title="TextBox control that sets up display of the employee numbers" longdesc="img_text/boxprops.htm" /><br />
<a id="sthref140" name="sthref140" href="img_text/boxprops.htm">Description of the illustration boxprops.gif</a><br />
<br /></li>
<li>
<p>When the project is run, the data identified by the <code>RecordSource</code> property is displayed using Oracle Data Control.</p>
<img width="300" height="245" src="img/runform.gif" alt="actual form as it appears when it runs, with sample data" title="actual form as it appears when it runs, with sample data" longdesc="img_text/runform.htm" /><br />
<a id="sthref141" name="sthref141" href="img_text/runform.htm">Description of the illustration runform.gif</a><br />
<br />
<p>You can also use Microsoft Grid Control to display all the data in the table. You need to add the grid control with the Components option of the Project menu.</p>
</li>
</ol>
</div>
<!-- class="sect2" -->
<a id="BABBFJBI" name="BABBFJBI"></a><a id="OOFOL140" name="OOFOL140"></a>
<div class="sect2">
<h3 class="sect2">Setting Oracle Data Control Properties Programmatically<a id="sthref142" name="sthref142"></a><a id="sthref143" name="sthref143"></a></h3>
<p>The following code fragment demonstrates how to programmatically set the properties of <span class="bold">Oracle Data Control</span> required to create a dynaset. These are the same properties that you can set with the <span class="bold">Properties</span> window in Visual Basic.</p>
<ol>
<li>
<p>Create a new project, and then in the <span class="bold">Components</span> option of the <span class="bold">Project</span> menu, add Oracle Data Control to the project.</p>
</li>
<li>
<p>Drag and drop <span class="bold">Oracle Data Control</span> onto a form. Change the name of the control to <code>OraDataControl</code>.</p>
</li>
<li>
<p>After you have inserted <span class="bold">Oracle Data Control</span> onto a form, add the following code to the load procedure associated with the form:</p>
<pre xml:space="preserve" class="oac_no_warn">... 
 
'Set the username and password. 
OraDataControl.Connect = "scott/tiger" 
 
'Set the database name. 
OraDataControl.DatabaseName = "ExampleDb" 
 
'Set the record source. 
OraDataControl.RecordSource = "select * from emp" 
 
'Refresh the data control. 
OraDataControl.Refresh 
... 
</pre>
<p>You now have a valid session, database, and dynaset that can be referenced as follows:</p>
<div class="inftblinformal">
<table class="Informal" title="Object Reference list" summary="rows are objects. column 1 is name, column 2 is reference" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="32%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t7">Object</th>
<th align="left" valign="bottom" id="r1c2-t7">Reference</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t7" headers="r1c1-t7"><code>orasession</code></td>
<td align="left" headers="r2c1-t7 r1c2-t7"><code>oradatacontrol.oradatabase.orasession</code></td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t7" headers="r1c1-t7"><code>oradatabase</code></td>
<td align="left" headers="r3c1-t7 r1c2-t7"><code>oradatacontrol.oradatabase</code></td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t7" headers="r1c1-t7">oradynaset</td>
<td align="left" headers="r4c1-t7 r1c2-t7"><code>oradatacontrol.recordset</code></td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" --></li>
<li>
<p>You can access the data in the <code>RecordSource</code> property using Visual Basic controls, such as the <span class="bold">TextBox</span>, as shown in the previous example.</p>
</li>
</ol>
</div>
<!-- class="sect2" --></div>
<!-- class="sect1" -->
<a id="CIHHECIH" name="CIHHECIH"></a><a id="OOFOL141" name="OOFOL141"></a>
<div class="sect1">
<h2 class="sect1">Using the Oracle Data Control with MS Visual C++<a id="sthref144" name="sthref144"></a><a id="sthref145" name="sthref145"></a><a id="sthref146" name="sthref146"></a><a id="sthref147" name="sthref147"></a><a id="sthref148" name="sthref148"></a><a id="sthref149" name="sthref149"></a><a id="sthref150" name="sthref150"></a><a id="sthref151" name="sthref151"></a><a id="sthref152" name="sthref152"></a></h2>
<p>This example shows how to create a basic Win32 Application with <span class="bold">Oracle Data Control</span> using MS Visual C++. This example assumes that both the Oracle data and DB Grid controls were registered on the system.</p>
<ol>
<li>
<p>Start the Microsoft Visual C++ program.</p>
</li>
<li>
<p>From the <span class="bold">File</span> Menu, select <span class="bold">New</span>.</p>
</li>
<li>
<p>In the <span class="bold">Projects</span> tab of the <span class="bold">New Window</span>, select <span class="bold">MFC</span> <span class="bold">AppWizard.exe</span>. Enter a project name, such as OO4O, and determine the location of the project. Click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In Step 1 of the <span class="bold">MFC</span> <span class="bold">AppWizard</span>, select <span class="bold">Dialog based</span> <span class="bold">application</span>, then click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In Step 2 of the wizard, make sure the <span class="bold">ActiveX Controls</span> box is checked; accept the defaults; and enter a title for the dialog box. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In Step 3 of the wizard, accept the defaults. Click <span class="bold">Next</span>.</p>
</li>
<li>
<p>In Step 4, click <span class="bold">Finish</span>. At the <span class="bold">New Project Information</span> screen, click <span class="bold">OK</span>.</p>
</li>
<li>
<p>In the <span class="bold">Project Workspace</span> dialog box, select the <span class="bold">ResourceView</span> tab. Expand the <span class="bold">Resources</span> folder, then expand the <span class="bold">Dialog</span> folder.</p>
</li>
<li>
<p>Double-click the main project dialog box to edit the dialog box.</p>
<p>Note: If you used OO4O as the project name, it is named <code>IDD_OO4O_DIALOG</code>.</p>
</li>
<li>
<p>Delete the default controls that are on the dialog box. Resize the dialog box to make it larger.</p>
</li>
<li>
<p>With the dialog box selected, click the right mouse button to display the menu. Select <span class="bold">Properties</span> from the menu. In the <span class="bold">General</span> tab of the <span class="bold">Properties</span> window, change the caption to <span class="bold">Oracle Data Control Example</span>. Close the <span class="bold">Properties</span> window.</p>
</li>
<li>
<p>With the dialog box selected, click the right mouse button to display the menu. Select <span class="bold">Insert ActiveX Control...</span> from the menu. Select <span class="bold">ORADC Control</span> in the window and then click <span class="bold">OK</span>.</p>
<img width="326" height="254" src="img/oradcins.gif" alt="The Insert ActiveX Control dialog box." title="The Insert ActiveX Control dialog box." longdesc="img_text/oradcins.htm" /><br />
<a id="sthref153" name="sthref153" href="img_text/oradcins.htm">Description of the illustration oradcins.gif</a><br />
<br /></li>
<li>
<p>Position the <span class="bold">ORADC Control</span> at the bottom of the dialog box. With the data control selected, click the right mouse button to display the menu. Select <span class="bold">Properties</span> from the menu.</p>
</li>
<li>
<p>In the <span class="bold">General</span> tab of the <span class="bold">Properties window</span>, change the <code>ID</code> to <code>IDC_ ORADATACONTROL</code>. Deselect the check mark for <span class="bold">Visible</span> so that the control is hidden when the application is run.</p>
</li>
<li>
<p>Display the <span class="bold">All</span> tab of the <span class="bold">Properties window</span> and set the following:</p>
<pre xml:space="preserve" class="oac_no_warn">Connect: scott/tiger 
DatabaseName: exampledb 
RecordSource: select * from emp 
</pre>
<img width="403" height="240" src="img/oradcprp.gif" alt="the ORADC Control dialog box" title="the ORADC Control dialog box" longdesc="img_text/oradcprp.htm" /><br />
<a id="sthref154" name="sthref154" href="img_text/oradcprp.htm">Description of the illustration oradcprp.gif</a><br />
<br /></li>
<li>
<p>With the dialog box selected, click the right mouse button to display the menu. Select the <span class="bold">Insert ActiveX</span> control from the menu. Locate the <span class="bold">DBGrid Control</span> and click <span class="bold">OK</span>.</p>
</li>
<li>
<p>Position the <span class="bold">DBGrid Control</span> at the top of the dialog box and resize it. Display the properties for the control. In the <span class="bold">All</span> tab of the <span class="bold">Properties</span> window, set the <code>DataSource</code> property to <span class="bold">Oracle Data Control</span> (<code>IDC_ORADATACONTROL</code>). Accept the defaults for the other properties. These can be changed later.</p>
</li>
<li>
<p>From the <span class="bold">File</span> Menu, select <span class="bold">Save All</span>.</p>
</li>
<li>
<p>Build and Execute the project.</p>
</li>
<li>
<p>The <span class="bold">DBGrid Control</span> displays the records from the <code>emp</code> table as in the following illustration:</p>
<img width="384" height="301" src="img/oradcemp.gif" alt="An ORADC Control example" title="An ORADC Control example" longdesc="img_text/oradcemp.htm" /><br />
<a id="sthref155" name="sthref155" href="img_text/oradcemp.htm">Description of the illustration oradcemp.gif</a><br />
<br /></li>
</ol>
</div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="intro.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="basfeat.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
