<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:55Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod085.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod087.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>ExecuteSQL Method</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod085.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod087.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="CIHEEIEC" name="CIHEEIEC"></a><a id="OOFOL546" name="OOFOL546"></a>
<hr />
<div class="refsect1">
<h1 class="refsect1">ExecuteSQL Method</h1>
<a id="sthref1173" name="sthref1173"></a>
<p class="titleinrefsubsect">Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
<a id="sthref1174" name="sthref1174"></a>
<p class="titleinrefsubsect">Description</p>
<p>Executes a single non-<code>SELECT</code> SQL statement or a PL/SQL block.</p>
<a id="sthref1175" name="sthref1175"></a>
<p class="titleinrefsubsect">Usage</p>
<pre xml:space="preserve" class="oac_no_warn">rowcount = oradatabase.ExecuteSQL(<span class="italic">sql_statement</span>)
rowcount = oradatabase.DbExecuteSQL(<span class="italic">sql_statement</span>)  
</pre>
<a id="sthref1176" name="sthref1176"></a>
<p class="titleinrefsubsect">Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="Informal" title="ExecuteSQL method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="25%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t119">Arguments</th>
<th align="left" valign="bottom" id="r1c2-t119">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t119" headers="r1c1-t119"><code><span class="codeinlineitalic">sql_statement</span></code></td>
<td align="left" headers="r2c1-t119 r1c2-t119">Any valid Oracle non-<code>SELECT</code> SQL statement.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="sthref1177" name="sthref1177"></a>
<p class="titleinrefsubsect">Remarks</p>
<p>Executes a SQL statement and returns the number of rows processed by that statement.</p>
<p>The <code><span class="codeinlineitalic">sql_statement</span></code> argument can be one continuous line with no breaks. If it is necessary to break the line, be sure to use line feeds (ASCII 10). Do not use carriage returns (ASCII 13), because the underlying Oracle Database functions treat carriage returns as null terminators.</p>
<p>Executing the SQL statement generates a commit to the database by default. To avoid this, use the <code>BeginTrans</code> method on the session object before using the <code>ExecuteSQL</code> method.</p>
<p>You can use PL/SQL bind variables in conjunction with the <code>OraParameters</code> collection.</p>
<p>When executing PL/SQL blocks or calling stored procedures, you must include a <code>BEGIN</code> and <code>END</code> statement around your call as if you were executing an anonymous PL/SQL block. This is equivalent to the <code>EXECUTE</code> command of SQL*Plus and SQL*DBA.</p>
<div class="infoboxnote">
<p class="notep1"><span class="bold">Note</span>:</p>
The <code>ExecuteSQL</code> method should be used with care because any SQL statement or PL/SQL block that is executed can adversely affect open dynasets. This is true if the <code>OraDatabase</code> object used for the <code>ExecuteSQL</code> method is the same as the one that was used to create the dynaset. Use a different <code>OraDatabase</code> object if you are unsure.</div>
<p>Normal dynaset operations can be adversely affected, if in transactional mode, a database commit is issued. This can happen if a SQL commit statement, a Data Control Language (DCL), or Data Definition Language (DDL) command is issued. DCL and DDL SQL commands, such as <code>CREATE</code>, <code>DROP</code>, <code>ALTER</code>, <code>GRANT</code>, and <code>REVOKE</code> always force a commit, which in turn commits everything done before them. See the <a class="olink SQLRF" href="http://www.oracle.com/pls/db102/lookup?id=SQLRF"><span class="italic">Oracle Database SQL Language Reference</span></a> for more details about DCL, DDL, and transactions.</p>
<a id="sthref1178" name="sthref1178"></a>
<p class="titleinrefsubsect">Data Type</p>
<p><code>Long</code> <code>Integer</code></p>
<a id="sthref1179" name="sthref1179"></a>
<p class="titleinrefsubsect">Examples</p>
<a id="OOFOL547" name="OOFOL547"></a><a id="CIHGHCGG" name="CIHGHCGG"></a>
<p class="subhead2">Example: ExecuteSQL</p>
<p>This example uses the <code>Add</code> and <code>Remove</code> parameter methods, the <code>ServerType</code> parameter property, and the <code>ExecuteSQL</code> database method to call the stored procedure <code>GetEmpName</code> and the stored function <code>GetSal</code>. Before running the example, run the <code>ORAEXAMP.SQL</code> file to create <code>GetEmpName</code> and <code>GetSal</code> as well as other necessary object types and LOBs in Oracle Database. Then, copy and paste this OO4O code example into the definition section of a form and run the program.</p>
<pre xml:space="preserve" class="oac_no_warn">Sub Form_Load ()
 
'Declare variables 
 Dim OraSession As OraSession
 Dim OraDatabase As OraDatabase 
 Dim OraDynaset As OraDatabase 
 
 'Create the OraSession Object.
 Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
 'Create the OraDatabase Object.
 Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
 'Add EMPNO as an Input/Output parameter and set its initial value.
 OraDatabase.Parameters.Add "EMPNO", 7369, ORAPARM_INPUT
 OraDatabase.Parameters("EMPNO").ServerType = ORATYPE_NUMBER
 
 'Add ENAME as an Output parameter and set its initial value.
 OraDatabase.Parameters.Add "ENAME", 0, ORAPARM_OUTPUT
 OraDatabase.Parameters("ENAME").ServerType = ORATYPE_VARCHAR2
 
 'Add SAL as an Output parameter and set its initial value.
 OraDatabase.Parameters.Add "SAL", 0, ORAPARM_OUTPUT
 OraDatabase.Parameters("SAL").ServerType = ORATYPE_NUMBER
 
 'Execute the Stored Procedure Employee.GetEmpName to retrieve ENAME.
 ' This Stored Procedure can be found in the file ORAEXAMP.SQL.
 OraDatabase.ExecuteSQL ("Begin Employee.GetEmpName (:EMPNO, :ENAME); end;")
 'Display the employee number and name.
 
 'Execute the Stored Function Employee.GetSal to retrieve SAL.
 ' This Stored Function can be found in the file ORAEXAMP.SQL.
 OraDatabase.ExecuteSQL ("declare SAL number(7,2); Begin" &amp; _  
                   ":SAL:=Employee.GetEmpSal (:EMPNO); end;")
 
 'Display the employee name, number and salary.
 MsgBox "Employee " &amp; OraDatabase.Parameters("ENAME").value &amp; ", #" &amp; _
           OraDatabase.Parameters("EMPNO").value &amp; ",Salary=" &amp; _
           OraDatabase.Parameters("SAL").value
 
 'Remove the Parameters.
 OraDatabase.Parameters.Remove "EMPNO"
 OraDatabase.Parameters.Remove "ENAME"
 
 OraDatabase.Parameters.Remove "SAL"
End Sub
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a class="olink SQLRF" href="http://www.oracle.com/pls/db102/lookup?id=SQLRF"><span class="italic">Oracle Database SQL Language Reference</span></a></p>
</li>
<li>
<p><a href="sermthod054.htm#CIHFHBEI">CreateDynaset Method</a></p>
</li>
<li>
<p><a href="serobjch030.htm#BABBFAHC">OraParameters Collection</a></p>
</li>
<li>
<p><a href="serprop132.htm#CHDGDDBC">Transactions Property</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod085.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod087.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
