<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:54Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod063.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod065.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>CreatePLSQLDynaset Method</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod063.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod065.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="BHBBIBHC" name="BHBBIBHC"></a><a id="OOFOL509" name="OOFOL509"></a>
<hr />
<div class="refsect1">
<h1 class="refsect1">CreatePLSQLDynaset Method</h1>
<a id="sthref1058" name="sthref1058"></a>
<p class="titleinrefsubsect">Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
<p><span class="italic">Deprecated</span>.</p>
<p>For information on how to perform these tasks, see <a href="basfeat.htm#BABJAAAF">"Returning PL/SQL Cursor Variables"</a>.</p>
<a id="sthref1059" name="sthref1059"></a>
<p class="titleinrefsubsect">Description</p>
<p>Creates a dynaset from a PL/SQL cursor. The SQL statement should be a stored procedure or an anonymous block. The resulting dynaset is read-only and attempting to set SQL property results in an error. Dynasets can be refreshed with new parameters similar to dynasets without cursors.</p>
<a id="sthref1060" name="sthref1060"></a>
<p class="titleinrefsubsect">Usage</p>
<pre xml:space="preserve" class="oac_no_warn">set OraDynaset = CreatePLSQLDynaset(<span class="italic">SQLStatement</span>, <span class="italic">CursorName</span>, <span class="italic">options</span>)
</pre>
<a id="sthref1061" name="sthref1061"></a>
<p class="titleinrefsubsect">Arguments</p>
<div class="inftblinformal">
<table class="Informal" title="CreatePLSQLDynaset method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="25%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t86">Arguments</th>
<th align="left" valign="bottom" id="r1c2-t86">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t86" headers="r1c1-t86"><code><span class="codeinlineitalic">SQLStatement</span></code></td>
<td align="left" headers="r2c1-t86 r1c2-t86">Any valid Oracle PL/SQL stored procedure or anonymous block.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t86" headers="r1c1-t86"><code><span class="codeinlineitalic">CursorName</span></code></td>
<td align="left" headers="r3c1-t86 r1c2-t86">Name of the cursor created in the PL/SQL stored procedure.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t86" headers="r1c1-t86"><code><span class="codeinlineitalic">options</span></code></td>
<td align="left" headers="r4c1-t86 r1c2-t86">A bit flag indicating the status of any optional states of the dynaset. You can combine one or more options by adding their respective values.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="OOFOL510" name="OOFOL510"></a>
<p class="subhead2">Constants</p>
<p>The options flag values are:</p>
<div class="inftblinformal">
<table class="Informal" title="CreatePLSQLDynaset Constants" summary="rows are constants. column 1 is name, column 2 value, column 3 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="32%" />
<col width="11%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t87">Constant</th>
<th align="left" valign="bottom" id="r1c2-t87">Value</th>
<th align="left" valign="bottom" id="r1c3-t87">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t87" headers="r1c1-t87"><code>ORADYN_DEFAULT</code></td>
<td align="left" headers="r2c1-t87 r1c2-t87"><code>&amp;H0&amp;</code></td>
<td align="left" headers="r2c1-t87 r1c3-t87">Accept the default behavior.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t87" headers="r1c1-t87"><code>ORADYN_NO_BLANKSTRIP</code></td>
<td align="left" headers="r3c1-t87 r1c2-t87"><code>&amp;H2&amp;</code></td>
<td align="left" headers="r3c1-t87 r1c3-t87">Do not remove trailing blanks from character string data retrieved from the database.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t87" headers="r1c1-t87"><code>ORADYN_NOCACHE</code></td>
<td align="left" headers="r4c1-t87 r1c2-t87"><code>&amp;H8&amp;</code></td>
<td align="left" headers="r4c1-t87 r1c3-t87">Do not create a local dynaset data cache. Without the local cache, previous rows within a dynaset are unavailable; however, increased performance results during retrieval of data from the database (move operations) and from the rows (field operations). Use this option in applications that make single passes through the rows of a dynaset for increased performance and decreased resource usage.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r5c1-t87" headers="r1c1-t87"><code>ORADYN_NO_MOVEFIRST</code></td>
<td align="left" headers="r5c1-t87 r1c2-t87"><code>&amp;H40&amp;</code></td>
<td align="left" headers="r5c1-t87 r1c3-t87">Do not force a <code>MoveFirst</code> operation when the dynaset is created. <code>BOF</code> and <code>EOF</code> are both true.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>These values can be found in the <code>oraconst.txt</code> file.</p>
<a id="sthref1062" name="sthref1062"></a>
<p class="titleinrefsubsect">Remarks</p>
<p>The SQL statement must be a PL/SQL stored procedure with <code>BEGIN</code> and <code>END</code> statements around the call, as if it were executed as an anonymous PL/SQL block; otherwise an error is returned. The <code><span class="codeinlineitalic">CursorName</span></code> argument should exactly match the cursor created inside the stored procedure or anonymous PL/SQL block; otherwise, an error is returned. Cursors created inside the stored procedure should represent a valid SQL <code>SELECT</code> statement.</p>
<p>You do not need to bind the PL/SQL cursor variable using the OraParameters.Add method if the stored procedure returns a cursor as a output parameter. You can still use PL/SQL bind variables in conjunction with the <code>OraParameters</code> collection.</p>
<p>This method automatically moves to the first row of the created dynaset.</p>
<p>Specifying the <code>ORADYN_READONLY</code>, <code>ORADYN_ORAMODE</code>, <code>ORADYN_NO_REFETCH</code>, or <code>ORADYN_DIRTY_WRITE</code> options have no effect on the dynaset creation.</p>
<a id="sthref1063" name="sthref1063"></a>
<p class="titleinrefsubsect">Examples</p>
<p>This example demonstrates the use of PL/SQL cursor in the <code>CreatePlsqlDynaset</code> method and <code>Refresh</code> method. This example returns a PL/SQL cursor as a dynaset for the different values of the <code>DEPTNO</code> parameter. Make sure that corresponding stored procedure (found in <code>EMPCUR.SQL</code>) is available in the Oracle database. and paste this code into the definition section of a form. Then, press <span class="bold">F5</span>.</p>
<pre xml:space="preserve" class="oac_no_warn">Sub Form_Load ()
 
 'Declare variables
 Dim OraSession As OraSession 
 Dim OraDatabase As OraDatabase 
 
 Dim OraDynaset As OraDynaset 
 
 'Create the OraSession Object.
 Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
 'Create the OraDatabase Object by opening a connection to Oracle.
 Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
' Create the Deptno parameter 
 OraDatabase.Parameters.Add "DEPTNO", 10, ORAPARM_INPUT
 OraDatabase.Parameters("DEPTNO").ServerType = ORATYPE_NUMBER 
 
' Create OraDynaset based on "EmpCursor" created in stored procedure. 
 Set OraDynaset = OraDatabase.CreatePLSQLDynaset("Begin Employee.GetEmpData" &amp; _
               "(:DEPTNO,:EmpCursor); end;", "EmpCursor", 0&amp;)
 
 'Should display KING
 MsgBox OraDynaset.Fields("ENAME").Value  
 
 'Should display 7839
 MsgBox OraDynaset.Fields("EMPNO").Value  
 
 ' Now set the deptno value to 20
 OraDatabase.Parameters("DEPTNO").Value = 20
 
 'Refresh the dynaset
 OraDynaset.Refresh
 
 'Should display JONES
 MsgBox OraDynaset.Fields("ENAME").Value  
 
 'Should display 7566
 MsgBox OraDynaset.Fields("EMPNO").Value   
 
  'Remove the parameter.
 OraDatabase.Parameters.Remove ("DEPTNO")
 
 End Sub
</pre></div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod063.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod065.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
