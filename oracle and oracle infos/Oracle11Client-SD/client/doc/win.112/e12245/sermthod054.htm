<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:53Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod053.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod055.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>CreateDynaset Method</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod053.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod055.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="CIHFHBEI" name="CIHFHBEI"></a><a id="OOFOL494" name="OOFOL494"></a>
<hr />
<div class="refsect1">
<h1 class="refsect1">CreateDynaset Method</h1>
<a id="sthref995" name="sthref995"></a>
<p class="titleinrefsubsect">Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
<a id="sthref996" name="sthref996"></a>
<p class="titleinrefsubsect">Description</p>
<p>Creates an <code>OraDynaset</code> object from the specified SQL <code>SELECT</code> statement and options.</p>
<a id="sthref997" name="sthref997"></a>
<p class="titleinrefsubsect">Usage</p>
<pre xml:space="preserve" class="oac_no_warn">Set oradynaset = oradatabase.CreateDynaset(<span class="italic">sql_statement</span>, <span class="italic">options</span>, SnapShotID)
Set oradynaset = oradatabase.DbCreateDynaset(<span class="italic">sql_statement</span>, <span class="italic">options</span>, <span class="italic">SnapShotID</span>)
</pre>
<a id="sthref998" name="sthref998"></a>
<p class="titleinrefsubsect">Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="Informal" title="CreateDynaset method parameter list" summary="Rows are arguments, column 1 names, column 2 descriptions" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="24%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t66">Arguments</th>
<th align="left" valign="bottom" id="r1c2-t66">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t66" headers="r1c1-t66"><code><span class="codeinlineitalic">sql_statement</span></code></td>
<td align="left" headers="r2c1-t66 r1c2-t66">A <code>String</code> containing any valid Oracle SQL <code>SELECT</code> statement.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t66" headers="r1c1-t66"><code><span class="codeinlineitalic">options</span></code></td>
<td align="left" headers="r3c1-t66 r1c2-t66">A bit flag indicating the status of any optional states of the dynaset. You can combine one or more options by adding their respective values. Specifying the constant <code>ORADYN_DEFAULT</code> or the value <code>&amp;H0&amp;</code> gives the following defaults for the dynaset:
<ul>
<li>
<p>Behave like Visual Basic Mode for a database: Field values not explicitly set are set to <code>Null</code>, overriding database column defaults.</p>
</li>
<li>
<p>Perform automatic binding of database parameters.</p>
</li>
<li>
<p>Remove trailing blanks from character string data retrieved from the database.</p>
</li>
<li>
<p>Create an updatable dynaset.</p>
</li>
<li>
<p>Cache data on client.</p>
</li>
<li>
<p>Force a <code>MoveFirst</code> when the dynaset is created.</p>
</li>
<li>
<p>Maintain read-consistency.</p>
</li>
</ul>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t66" headers="r1c1-t66"><code><span class="codeinlineitalic">SnapShotID</span></code> [optional]</td>
<td align="left" headers="r4c1-t66 r1c2-t66">A <code>ID</code> of the snapshot obtained from the <code>SnapShot</code> property of an <code>OraDynaset</code> object.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="OOFOL495" name="OOFOL495"></a>
<p class="subhead2">Constants</p>
<p>The following table lists constants and values for the options flag.</p>
<div class="inftblinformal">
<table class="Informal" title="CreateDynaset Constants" summary="rows are constants. column 1 is name, column 2 value, column 3 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="31%" />
<col width="10%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t67">Constant</th>
<th align="left" valign="bottom" id="r1c2-t67">Value</th>
<th align="left" valign="bottom" id="r1c3-t67">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t67" headers="r1c1-t67"><code>ORADYN_DEFAULT</code></td>
<td align="left" headers="r2c1-t67 r1c2-t67"><code>&amp;H0&amp;</code></td>
<td align="left" headers="r2c1-t67 r1c3-t67">Accept the default behavior.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t67" headers="r1c1-t67"><code>ORADYN_NO_AUTOBIND</code></td>
<td align="left" headers="r3c1-t67 r1c2-t67"><code>&amp;H1&amp;</code></td>
<td align="left" headers="r3c1-t67 r1c3-t67">Do not perform automatic binding of database parameters.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t67" headers="r1c1-t67"><code>ORADYN_NO_BLANKSTRIP</code></td>
<td align="left" headers="r4c1-t67 r1c2-t67"><code>&amp;H2&amp;</code></td>
<td align="left" headers="r4c1-t67 r1c3-t67">Do not remove trailing blanks from character string data retrieved from the database.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r5c1-t67" headers="r1c1-t67"><code>ORADYN_READONLY</code></td>
<td align="left" headers="r5c1-t67 r1c2-t67"><code>&amp;H4&amp;</code></td>
<td align="left" headers="r5c1-t67 r1c3-t67">Force dynaset to be read-only.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r6c1-t67" headers="r1c1-t67"><code>ORADYN_NOCACHE</code></td>
<td align="left" headers="r6c1-t67 r1c2-t67"><code>&amp;H8&amp;</code></td>
<td align="left" headers="r6c1-t67 r1c3-t67">Do not create a local dynaset data cache. Without the local cache, previous rows within a dynaset are unavailable; however, increased performance results during retrieval of data from the database (move operations) and from the rows (field operations). Use this option in applications that make single passes through the rows of a dynaset for increased performance and decreased resource usage.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r7c1-t67" headers="r1c1-t67"><code>ORADYN_ORAMODE</code></td>
<td align="left" headers="r7c1-t67 r1c2-t67"><code>&amp;H10&amp;</code></td>
<td align="left" headers="r7c1-t67 r1c3-t67">Behave the same as Oracle Mode for a database except affect only the dynaset being created. If database was created in Oracle Mode, the dynaset inherits the property from it (for compatibility).</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r8c1-t67" headers="r1c1-t67"><code>ORADYN_NO_REFETCH</code></td>
<td align="left" headers="r8c1-t67 r1c2-t67"><code>&amp;H20&amp;</code></td>
<td align="left" headers="r8c1-t67 r1c3-t67">Behave the same as <code>ORADB_NO_REFETCH</code> mode for a database except affect only the dynaset being created. If the database was created in <code>ORADB_NO_REFETCH</code> mode, the dynaset inherits the property for compatibility.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r9c1-t67" headers="r1c1-t67"><code>ORADYN_NO_MOVEFIRST</code></td>
<td align="left" headers="r9c1-t67 r1c2-t67"><code>&amp;H40&amp;</code></td>
<td align="left" headers="r9c1-t67 r1c3-t67">Does not force a <code>MoveFirst</code> when the dynaset is created. <code>BOF</code> and <code>EOF</code> are both true.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r10c1-t67" headers="r1c1-t67"><code>ORADYN_DIRTY_WRITE</code></td>
<td align="left" headers="r10c1-t67 r1c2-t67"><code>&amp;H80&amp;</code></td>
<td align="left" headers="r10c1-t67 r1c3-t67"><code>Update</code> and <code>Delete</code> methods do not check for read consistency.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>These values can be found in the <code>oraconst.txt</code> file.</p>
<a id="sthref999" name="sthref999"></a>
<p class="titleinrefsubsect">Remarks</p>
<p>Features such as simple views and synonyms can be used freely. You can also use schema references, column aliases, table joins, nested select statements and remote database references, but in each case, the dynaset is read-only.</p>
<p>If you use a complex expression or SQL function on a column, such as <code>"sal + 100"</code> or <code>"abs(sal)"</code> , you get an updatable dynaset, but the column associated with the complex expression is not updatable.</p>
<p>Object names generally are not modifed, but in certain cases they can be changed. For example, if you use a column alias, you must use the alias to refer to the field by name. Also, if you use spaces in a complex expression, you must refer to the column without the spaces, since the database strips spaces. Note that you can always refer to a field by number, that is, by its ordinal position in the <code>SELECT</code> statement.</p>
<p>Executing the <code>Update</code> method generates a commit operation to the database by default. To avoid this, use the <code>BeginTrans</code> method on the session object before using the <code>CreateDynaset</code> method.</p>
<p>The updatability of the resultant dynaset depends on the Oracle SQL rules of updatability, on the access you have been granted, and on the options flag. For the dynaset to be updatable, these conditions must be met:</p>
<ul>
<li>
<p>A SQL statement must refer to a simple column list or to the entire column list (*).</p>
</li>
<li>
<p>The statement must not set the read-only flag of the options argument.</p>
</li>
<li>
<p>Oracle Database must permit <code>ROWID</code> references to the selected rows of the query.</p>
</li>
</ul>
<p>Any SQL statement that does not meet these criteria is processed, but the results are not updatable and the <code>Updatable</code> property of the dynaset returns <code>False</code>. This method automatically moves to the first row of the created dynaset. You can use SQL bind variables in conjunction with the <code>OraParameters</code> collection.</p>
<p>The <code>SnapShotID</code> option causes a snapshot descriptor to be created for the <code>SQLStmt</code> object created. This property can later be obtained and used in creation of other <code>SQLStmt</code> or <code>OraDynaset</code> objects. Execution snapshots provide the ability to ensure that multiple commands executed in the context of multiple <code>OraDatabase</code> objects operate on the same consistent snapshot of the committed data in the database.</p>
<a id="sthref1000" name="sthref1000"></a>
<p class="titleinrefsubsect">Examples</p>
<p>This example demonstrates <code>CreateObject</code>, <code>OpenDatabase</code> and <code>CreateDynaset</code> methods. Copy and paste this code into the definition section of a form. Then, press <span class="bold">F5</span>.</p>
<pre xml:space="preserve" class="oac_no_warn">Sub Form_Load ()
 
 'Declare variables
 Dim OraSession As OraSession 
 Dim OraDatabase As OraDatabase 
 Dim OraDynaset As OraDynaset 
 
 'Create the OraSession Object.
 Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
 'Create the OraDatabase Object by opening a connection to Oracle.
 Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
 'Create the OraDynaset Object.
 Set OraDynaset = OraDatabase.CreateDynaset("select empno, ename from emp", 0&amp;)
 
 'Display the first record.
 MsgBox "Employee " &amp; OraDynaset.Fields("empno").value &amp; ", #" &amp; _
                OraDynaset.Fields("ename").value
 
End Sub
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="sermthod030.htm#CIHDGBHB">Clone Method</a></p>
</li>
<li>
<p><a href="sermthod131.htm#CIHIHCBD">MoveFirst, MoveLast, MoveNext, and MovePrevious Methods</a></p>
</li>
<li>
<p><a href="sermthod132.htm#CIHGJGDB">MovePreviousn, MoveNextn, MoveRel, and MoveTo Methods</a></p>
</li>
<li>
<p><a href="sermthod141.htm#CIHCBJHD">OpenDatabase Method</a></p>
</li>
<li>
<p><a href="serprop139.htm#CHDEBEDF">Updatable Property</a></p>
</li>
<li>
<p><a href="serobjch011.htm#BABJBBAI">OraDynaset Object</a></p>
</li>
<li>
<p><a href="serobjch020.htm#BABDIJAH">OraParameter Object</a></p>
</li>
<li>
<p><a href="serobjch030.htm#BABBFAHC">OraParameters Collection</a></p>
</li>
<li>
<p><a href="sermthod174.htm#CIHBBCJA">Update Method</a></p>
</li>
<li>
<p><a href="sermthod024.htm#CIHDADDI">BeginTrans Method</a></p>
</li>
<li>
<p><a href="serprop121.htm#CHDCIJJD">SnapShot Property</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod053.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod055.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
