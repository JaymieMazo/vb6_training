<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-21T17:54:54Z" />
<meta name="doctitle" content="Oracle&reg; Objects for OLE Developer's Guide 11g Release 2 (11.2) for Microsoft Windows" />
<meta name="partno" content="E12245-01" />
<meta name="docid" content="OOFOL" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="sermthod065.htm" title="Previous" type="text/html" />
<link rel="Next" href="sermthod067.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12245.pdf" title="PDF version" type="application/pdf" />
<title>CreateSQL Method</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Objects for OLE Developer's Guide<br />
11<i>g</i> Release 2 (11.2) for Microsoft Windows</b><br />
Part Number E12245-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod065.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod067.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12245.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="BHBDJJIG" name="BHBDJJIG"></a><a id="OOFOL512" name="OOFOL512"></a>
<hr />
<div class="refsect1">
<h1 class="refsect1">CreateSQL Method</h1>
<a id="sthref1070" name="sthref1070"></a>
<p class="titleinrefsubsect">Applies To</p>
<p><a href="serobjch010.htm#BABGDAJI">OraDatabase Object</a></p>
<a id="sthref1071" name="sthref1071"></a>
<p class="titleinrefsubsect">Description</p>
<p>Executes the SQL statement and creates an <code>OraSQLStmt</code> object from the specified SQL statement and options.</p>
<a id="sthref1072" name="sthref1072"></a>
<p class="titleinrefsubsect">Usage</p>
<pre xml:space="preserve" class="oac_no_warn">Set orasqlstmt = oradatabase.CreateSQL(<span class="italic">sql_statement</span>, <span class="italic">options</span>)
</pre>
<a id="sthref1073" name="sthref1073"></a>
<p class="titleinrefsubsect">Arguments</p>
<p>The arguments for the method are:</p>
<div class="inftblinformal">
<table class="Informal" title="CreateSQL method parameter list" summary="rows are arguments, column 1 is name, column 2 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="25%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t90">Arguments</th>
<th align="left" valign="bottom" id="r1c2-t90">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t90" headers="r1c1-t90"><code><span class="codeinlineitalic">sql_statement</span></code></td>
<td align="left" headers="r2c1-t90 r1c2-t90">Any valid Oracle SQL statement.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t90" headers="r1c1-t90"><code><span class="codeinlineitalic">options</span></code></td>
<td align="left" headers="r3c1-t90 r1c2-t90">A bit flag indicating the status of any optional states of the <code>OraSQLStmt</code> object. You can combine one or more options by adding their respective values.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<a id="OOFOL513" name="OOFOL513"></a>
<p class="subhead2">Constants</p>
<p>The options flag values are:</p>
<div class="inftblinformal">
<table class="Informal" title="CreateSQL constants" summary="rows are constants. column 1 is name, column 2 value, column 3 description" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="34%" />
<col width="14%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t91">Constant</th>
<th align="left" valign="bottom" id="r1c2-t91">Value</th>
<th align="left" valign="bottom" id="r1c3-t91">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t91" headers="r1c1-t91"><code>ORASQL_NO_AUTOBIND</code></td>
<td align="left" headers="r2c1-t91 r1c2-t91"><code>&amp;H1&amp;</code></td>
<td align="left" headers="r2c1-t91 r1c3-t91">Do not perform automatic binding of database parameters.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t91" headers="r1c1-t91"><code>ORASQL_FAILEXEC</code></td>
<td align="left" headers="r3c1-t91 r1c2-t91"><code>&amp;H2&amp;</code></td>
<td align="left" headers="r3c1-t91 r1c3-t91">Raise error and do not create SQL statement object.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t91" headers="r1c1-t91"><code>ORASQL_NONBLK</code></td>
<td align="left" headers="r4c1-t91 r1c2-t91"><code>&amp;H4&amp;</code></td>
<td align="left" headers="r4c1-t91 r1c3-t91">Execute SQL in a nonblocking state.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p>These values can be found in the <code>oraconst.txt</code> file.</p>
<a id="sthref1074" name="sthref1074"></a>
<p class="titleinrefsubsect">Remarks</p>
<p>The SQL statement can be one continuous line with no breaks. If it is necessary to break the line, be sure to use line feeds (ASCII 10). Do not use carriage returns (ASCII 13), because the underlying Oracle Database functions treat carriage returns as null terminators.</p>
<p>You can use PL/SQL bind variables in conjunction with the <code>OraParameters</code> collection.</p>
<p>Executing the SQL statement generates a commit to the database by default. To avoid this, use the <code>BeginTrans</code> method on the session object before using the <code>CreateSQL</code> method.</p>
<p>When executing PL/SQL blocks or calling stored procedures, you must include a <code>BEGIN</code> and <code>END</code> statement around your call as if you were executing an anonymous PL/SQL block. This is equivalent to the <code>EXECUTE</code> command of SQL*Plus and SQL*DBA.</p>
<p>If the <code>ORASQL_FAILEXEC</code> option is used, an error is raised during <code>SQLstmt</code> object creation failure (on <code>SQLstmt</code> object refresh). The <code>SQLstmt</code> object is not created and cannot be refreshed.</p>
<div class="infoboxnote">
<p class="notep1"><span class="bold">Note</span>:</p>
Use the <code>CreateSQL</code> method with care, because any SQL statement or PL/SQL block that is executed might cause errors afterward when you use the <code>Edit</code> method on open dynasets.</div>
<a id="sthref1075" name="sthref1075"></a>
<p class="titleinrefsubsect">Data Type</p>
<p><code>String</code></p>
<a id="sthref1076" name="sthref1076"></a>
<p class="titleinrefsubsect">Examples</p>
<p>This example demonstrates the use of parameters, the <code>CreateSQL</code> method, the <code>Refresh</code> method, and the SQL property for <code>OraSQLStmt</code> object. Copy and paste this code into the definition section of a form. Then, press <span class="bold">F5</span>.</p>
<pre xml:space="preserve" class="oac_no_warn">Sub Form_Load ()
 
 'Declare variables 
 Dim OraSession As OraSession 
 Dim OraDatabase As OraDatabase 
 Dim OraSqlStmt As OraSQLStmt 
 
 'Create the OraSession Object.
 Set OraSession = CreateObject("OracleInProcServer.XOraSession")
 
 'Create the OraDatabase Object by opening a connection to Oracle.
 Set OraDatabase = OraSession.OpenDatabase("ExampleDb", "scott/tiger", 0&amp;)
 
 OraDatabase.Parameters.Add "EMPNO", 7369, 1
 OraDatabase.Parameters("EMPNO").ServerType = 2  'ORATYPE_NUMBER 
 
 OraDatabase.Parameters.Add "ENAME", 0, 2
 OraDatabase.Parameters("ENAME").ServerType = 1  'ORATYPE_VARCHAR2  
 
 Set OraSqlStmt = OraDatabase.CreateSQL("Begin Employee.GetEmpName" &amp; _ 
          "(:EMPNO, :ENAME); end;", 0&amp;) 
 
 'Notice that the SQL statement is NOT modified.
 MsgBox OraSqlStmt.SQL
 
 'Should display SMITH
 MsgBox OraDatabase.Parameters("ENAME").Value  
 
 'Change the value of the empno parameter.
 OraDatabase.Parameters("EMPNO").Value = 7499
 
 'Refresh the sqlstmt
 OraSqlStmt.Refresh
 
 'Should display ALLEN
 MsgBox OraDatabase.Parameters("ENAME").Value   
 
 'Notice that the SQL statement is NOT modified.
 MsgBox OraSqlStmt.SQL  
 
 'Remove the parameter.
 OraDatabase.Parameters.Remove ("job")
 
 End Sub
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="basfeat.htm#BGBEAFID">"Asynchronous Processing"</a> for more information about the <code>ORASQL_NONBLK</code> option</p>
</li>
<li>
<p><a href="sermthod024.htm#CIHDADDI">BeginTrans Method</a></p>
</li>
<li>
<p><a href="serobjch024.htm#BABGAHBH">OraSQLStmt Object</a></p>
</li>
<li>
<p><a href="#BHBDJJIG">CreateSQL Method</a></p>
</li>
<li>
<p><a href="sermthod086.htm#CIHEEIEC">ExecuteSQL Method</a></p>
</li>
<li>
<p><a href="sermthod148.htm#CIHJFCGG">Refresh Method</a></p>
</li>
</ul>
</div>
</div>
<!-- class="refsect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="sermthod065.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="sermthod067.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1994, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
