<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="robots" content="all" scheme="http://www.robotstxt.org/" />
<meta name="generator" content="Oracle DARB XHTML Converter (Mode = document) - Version 5.1.1 Build 026" />
<meta name="Date" content="2010-01-27T18:53:55Z" />
<meta name="doctitle" content="Oracle&reg; Data Provider for .NET Developer's Guide 11g Release 2 (11.2)" />
<meta name="partno" content="E12249-01" />
<meta name="docid" content="ODPNT" />
<link rel="Start" href="../../index.htm" title="Home" type="text/html" />
<link rel="Copyright" href="../../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />
<link rel="Stylesheet" href="../../dcommon/css/blafdoc.css" title="Default" type="text/css" />
<script type="text/javascript" src="../../dcommon/js/doccd.js">
</script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Index" href="index.htm" title="Index" type="text/html" />
<link rel="Glossary" href="glossary.htm" title="Glossary" type="text/html" />
<link rel="Prev" href="featLOBsupp.htm" title="Previous" type="text/html" />
<link rel="Next" href="featUDTs.htm" title="Next" type="text/html" />
<link rel="alternate" href="../e12249.pdf" title="PDF version" type="application/pdf" />
<title>ODP.NET XML Support</title>
</head>
<body>
<div class="header">
<div class="zz-skip-header"><a name="top" id="top" href="#BEGIN">Skip Headers</a></div>
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top"><b>Oracle&reg; Data Provider for .NET Developer's Guide<br />
11<i>g</i> Release 2 (11.2)</b><br />
Part Number E12249-01</td>
<td valign="bottom" align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td align="left" valign="top">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="featLOBsupp.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="featUDTs.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td align="right" valign="top" style="font-size: 90%"><a href="../e12249.pdf">View PDF</a></td>
</tr>
</table>
<a name="BEGIN" id="BEGIN"></a></div>
<div class="IND"><!-- End Header --><a id="i1012109" name="i1012109"></a>
<div class="sect1">
<h1 class="sect1"><a name="ODPNT0020" id="ODPNT0020"></a>ODP.NET XML Support<a id="sthref460" name="sthref460"></a><a id="sthref461" name="sthref461"></a><a id="sthref462" name="sthref462"></a><a id="sthref463" name="sthref463"></a><a id="sthref464" name="sthref464"></a></h1>
<p>ODP.NET allows the extraction of data from relational and object-relational tables and views as XML documents. The use of XML documents for insert, update, and delete operations to the database is also allowed. Oracle Database supports XML natively in the database, through Oracle XML DB, a distinct group of technologies related to high-performance XML storage and retrieval. Oracle XML DB is an evolution of the database that encompasses both SQL and XML data models in a highly interoperable manner, providing native XML support.</p>
<p>For samples related to ODP.NET XML support, see the following directory:</p>
<pre xml:space="preserve" class="oac_no_warn"><span class="italic">ORACLE_BASE</span>\<span class="italic">ORACLE_HOME</span>\ODP.NET\Samples
</pre>
<p>This section includes these topics:</p>
<ul>
<li>
<p><a href="#i1012135">Supported XML Features</a></p>
</li>
<li>
<p><a href="#i1012265">OracleXmlType and Connection Dependency</a></p>
</li>
<li>
<p><a href="#i1012461">Updating XMLType Data in the Database</a></p>
</li>
<li>
<p><a href="#i1010698">Updating XML Data in OracleXmlType</a></p>
</li>
<li>
<p><a href="#i1015150">Characters with Special Meaning in XML</a></p>
</li>
<li>
<p><a href="#i1013872">Retrieving Query Result Set as XML</a></p>
</li>
<li>
<p><a href="#i1012662">Data Manipulation Using XML</a></p>
</li>
</ul>
<a id="i1012135" name="i1012135"></a>
<div class="sect2">
<h2 class="sect2">Supported XML Features</h2>
<p>XML support in ODP.NET provides the ability to do the following:</p>
<ul>
<li>
<p>Store XML data natively in the database as the Oracle database native type, <code>XMLType</code>.</p>
</li>
<li>
<p>Access relational and object-relational data as XML data from an Oracle Database instance into the Microsoft .NET environment, and process the XML using the Microsoft .NET Framework.</p>
</li>
<li>
<p>Save changes to the database using XML data.</p>
</li>
<li>
<p>Execute XQuery statements<a id="sthref465" name="sthref465"></a><a id="sthref466" name="sthref466"></a><a id="sthref467" name="sthref467"></a><a id="sthref468" name="sthref468"></a><a id="sthref469" name="sthref469"></a>.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#CJAJHEGG">"XQuery Support"</a></div>
</li>
</ul>
<p>For the .NET application developer, these features include the following:</p>
<ul>
<li>
<p>Enhancements to the <code>OracleCommand</code>, <code>OracleConnection</code>, and <code>OracleDataReader</code> classes.</p>
</li>
<li>
<p>The following XML-specific classes:</p>
<ul>
<li>
<p><code>OracleXmlType</code></p>
<p><code>OracleXmlType</code> objects are used to retrieve Oracle native <code>XMLType</code> data.</p>
</li>
<li>
<p><code>OracleXmlStream</code></p>
<p><code>OracleXmlStream</code> objects are used to retrieve XML data from <code>OracleXmlType</code> objects as a read-only .NET <code>Stream</code> object.</p>
</li>
<li>
<p><code>OracleXmlQueryProperties</code></p>
<p><code>OracleXmlQueryProperties</code> objects represent the XML properties used by the <code>OracleCommand</code> class when the <code>XmlCommandType</code> property is <code>Query</code>.</p>
</li>
<li>
<p><code>OracleXmlSaveProperties</code></p>
<p><code>OracleXmlSaveProperties</code> objects represent the XML properties used by the <code>OracleCommand</code> class when the <code>XmlCommandType</code> property is <code>Insert</code>, <code>Update</code>, or <code>Delete</code>.</p>
</li>
</ul>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<ul>
<li>
<p><a href="OracleCommandClass.htm#i996876">"OracleCommand Class"</a></p>
</li>
<li>
<p><a href="OracleXmlTypeClass.htm#i1033889">"OracleXmlType Class"</a></p>
</li>
<li>
<p><a href="OracleXmlStreamClass.htm#i1033513">"OracleXmlStream Class"</a></p>
</li>
<li>
<p><a href="OracleXmlQueryPropertiesClass.htm#i1016004">"OracleXmlQueryProperties Class"</a></p>
</li>
<li>
<p><a href="OracleXmlSavePropertiesClass.htm#i1016516">"OracleXmlSaveProperties Class"</a></p>
</li>
<li>
<p><span class="italic"><a class="olink ADXDB" href="http://www.oracle.com/pls/db102/lookup?id=ADXDB">Oracle XML DB Developer's Guide</a></span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="CJAJHEGG" name="CJAJHEGG"></a>
<div class="sect2">
<h2 class="sect2">XQuery Support<a id="sthref470" name="sthref470"></a><a id="sthref471" name="sthref471"></a></h2>
<p>Beginning with Oracle Database 10<span class="italic">g</span> release 2(10.2), ODP.NET supports the XQuery language through a native implementation of SQL/XML functions, <code>XMLQuery</code> and <code>XMLTable</code>. When executing XQuery statements, Oracle XML DB generally evaluates XQuery expressions by compiling them into the same underlying structures as relational queries. Queries are optimized, leveraging both relational-database and XQuery-specific optimization technologies, so that Oracle XML DB serves as a native XQuery engine.The treatment of all XQuery expressions, whether natively compiled or evaluated functionally, is transparent: programmers do not need to change their code to take advantage of XQuery optimizations.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<span class="italic"><a class="olink ADXDB1700" href="http://www.oracle.com/pls/db102/lookup?id=ADXDB1700">Oracle XML DB Developer's Guide</a></span> to learn more about Oracle's XQuery support</div>
</div>
<!-- class="sect2" -->
<a id="i1012265" name="i1012265"></a>
<div class="sect2">
<h2 class="sect2">OracleXmlType and Connection Dependency<a id="sthref472" name="sthref472"></a><a id="sthref473" name="sthref473"></a><a id="sthref474" name="sthref474"></a></h2>
<p>The read-only <code>Connection</code> property of the <code>OracleXmlType</code> class holds a reference to the <code>OracleConnection</code> object used to instantiate the <code>OracleXmlType</code> class.</p>
<p>How the <code>OracleXmlType</code> object obtains a reference to an <code>OracleConnection</code> object depends on how the <code>OracleXmlType</code> class is instantiated:</p>
<ul>
<li>
<p>Instantiated from an <code>OracleDataReader</code> class using the <code>GetOracleXmlType</code>, <code>GetOracleValue</code>, or <code>GetOracleValues</code> method:</p>
<p>The <code>Connection</code> property is set with a reference to the same <code>OracleConnection</code> object used by the <code>OracleDataReader</code> object.</p>
</li>
<li>
<p>Instantiated by invoking an <code>OracleXmlType</code> constructor with one of the parameters of type <code>OracleConnection</code>:</p>
<p>The <code>Connection</code> property is set with a reference to the same <code>OracleConnection</code> object provided in the constructor.</p>
</li>
<li>
<p>Instantiated by invoking an <code>OracleXmlType(OracleClob)</code> constructor:</p>
<p>The <code>Connection</code> property is set with a reference to the <code>OracleConnection</code> object used by the <code>OracleClob</code> object.</p>
</li>
</ul>
<p>An <code>OracleXmlType</code> object that is associated with one connection cannot be used with a different connection. For example, if an <code>OracleXmlType</code> object is obtained using <code>OracleConnection</code> <code>A</code>, that <code>OracleXmlType</code> object cannot be used as an input parameter of a command that uses <code>OracleConnection</code> <code>B</code>. By checking the <code>Connection</code> property of the <code>OracleXmlType</code> objects, the application can ensure that <code>OracleXmlType</code> objects are used only within the context of the <code>OracleConnection</code> referenced by its connection property. Otherwise, ODP.NET raises an exception.</p>
</div>
<!-- class="sect2" -->
<a id="i1012461" name="i1012461"></a>
<div class="sect2">
<h2 class="sect2">Updating XMLType Data in the Database</h2>
<p>Updating <code>XMLType</code> columns does not require a transaction. However, encapsulating the entire database update process within a transaction is highly recommended. This allows the updates to be rolled back if there are any errors.</p>
<p><code>XMLType</code> columns in the database can be updated using Oracle Data Provider for .NET in a few ways:</p>
<ul>
<li>
<p><a href="#i1009704">Updating with DataSet, OracleDataAdapter, and OracleCommandBuilder</a></p>
</li>
<li>
<p><a href="#i1009708">Updating with OracleCommand and OracleParameter</a></p>
</li>
</ul>
<a id="i1009704" name="i1009704"></a>
<div class="sect3">
<h3 class="sect3">Updating with DataSet, OracleDataAdapter, and OracleCommandBuilder<a id="sthref475" name="sthref475"></a><a id="sthref476" name="sthref476"></a></h3>
<p>If the <code>XMLType</code> column is fetched into the <code>DataSet</code>, the <code>XMLType</code> data is represented as a .NET <code>String</code>.</p>
<p>Modifying <code>XMLType</code> data in the <code>DataSet</code> does not require special treatment. <code>XMLType</code> data can be modified in the same way as any data that is stored in the <code>DataSet</code>. When a change is made and the <code>OracleDataAdapter.Update</code> method is invoked, the <code>OracleDataAdapter</code> object ensures that the <code>XMLType</code> data is handled properly. The <code>OracleDataAdapter</code> object uses any custom SQL <code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code> statements that are provided. Otherwise, valid SQL statements are generated by the <code>OracleCommandBuilder</code> object as needed to <a href="glossary.htm#i433214"><span class="xrefglossterm">flush</span></a> the changes to the database.</p>
</div>
<!-- class="sect3" -->
<a id="i1009708" name="i1009708"></a>
<div class="sect3">
<h3 class="sect3">Updating with OracleCommand and OracleParameter<a id="sthref477" name="sthref477"></a></h3>
<p>The <code>OracleCommand</code> class provides a powerful way of updating <code>XMLType</code> data, especially with the use of an <code>OracleParameter</code> object. To update columns in a database table, the new value for the column can be passed as an input parameter of a command.</p>
<div class="sect4"><a id="sthref478" name="sthref478"></a>
<h4 class="sect4">Input Binding<a id="sthref479" name="sthref479"></a></h4>
<p>To update an <code>XMLType</code> column in the database, a SQL statement can be executed using static values. In addition, input parameters can be bound to SQL statements, anonymous PL/SQL blocks, or stored procedures to update <code>XMLType</code> columns. The parameter value can be set as .NET Framework Types, ODP.NET Types, or <code>OracleXmlType</code> objects.</p>
<p>While <code>XMLType</code> columns can be updated using an <code>OracleXmlType</code> object, having an instance of an <code>OracleXmlType</code> class does not guarantee that the <code>XMLType</code> column in the database can be updated.</p>
</div>
<!-- class="sect4" -->
<div class="sect4"><a id="sthref480" name="sthref480"></a>
<h4 class="sect4">Setting XMLType Column to NULL Value<a id="sthref481" name="sthref481"></a></h4>
<p>Applications can set an <code>XMLType</code> column in the database to a <code>NULL</code> value, with or without input binding, as follows:</p>
<ul>
<li>
<p>Setting <code>NULL</code> values in an <code>XMLType</code> column with input binding</p>
<p>To set the <code>XMLType</code> column to <code>NULL</code>, the application can bind an input parameter whose value is <code>DBNull</code>.<code>Value</code>. This indicates to the <code>OracleCommand</code> object that a <code>NULL</code> value is to be inserted.</p>
<p>Passing in a null <code>OracleXmlType</code> object as an input parameter does not insert a <code>NULL</code> value into the <code>XMLType</code> column. In this case, the <code>OracleCommand</code> object raises an exception.</p>
</li>
<li>
<p>Setting <code>NULL</code> Values in an <code>XMLType</code> Column without input binding</p>
<p>The following example demonstrates setting <code>NULL</code> values in an <code>XMLType</code> column without input binding:</p>
<pre xml:space="preserve" class="oac_no_warn">// Create a table with an XMLType column in the database
CREATE TABLE XML_TABLE(NUM_COL number, XMLTYPE_COL xmltype);
</pre>
<p>An application can set a <code>NULL</code> value in the <code>XMLType</code> column by explicitly inserting a <code>NULL</code> value or by not inserting anything into that column as in the following examples:</p>
<pre xml:space="preserve" class="oac_no_warn">insert into xml_table(xmltype_col) values(NULL);
</pre>
<pre xml:space="preserve" class="oac_no_warn">update xml_table t set t.xmltype_col=NULL;
</pre></li>
</ul>
</div>
<!-- class="sect4" -->
<div class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref482" name="sthref482"></a>
<h4 class="sect4">Setting XMLType Column to Empty XML Data</h4>
<p>The <code>XMLType</code> column can be initialized with empty XML data, using a SQL statement:</p>
<pre xml:space="preserve" class="oac_no_warn">// Create a table with an XMLType column in the database
CREATE TABLE XML_TABLE(NUM_COL number, XMLTYPE_COL xmltype);
</pre>
<pre xml:space="preserve" class="oac_no_warn">INSERT INTO XML_TABLE (NUM_COL, XMLTYPE_COL) VALUES (4, 
      XMLType.createxml('&lt;DOC/&gt;'));
</pre></div>
<!-- class="sect4" --></div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1010698" name="i1010698"></a>
<div class="sect2">
<h2 class="sect2">Updating XML Data in OracleXmlType<a id="sthref483" name="sthref483"></a></h2>
<p>The following are ways that XML data can be updated in an <code>OracleXmlType</code> object.</p>
<ul>
<li>
<p>The XML data can be updated by passing an XPATH expression and the new value to the <code>Update</code> method on the <code>OracleXmlType</code> object.</p>
</li>
<li>
<p>The XML data can be retrieved on the client side as the .NET Framework <code>XmlDocument</code> object using the <code>GetXmlDocument</code> method on the <code>OracleXmlType</code> object. This XML data can then be manipulated using suitable .NET Framework classes. A new <code>OracleXmlType</code> can be created with the updated XML data from the .NET Framework classes. This new <code>OracleXmlType</code> is bound as an input parameter to an update or insert statement.</p>
</li>
</ul>
</div>
<!-- class="sect2" -->
<a id="i1015150" name="i1015150"></a>
<div class="sect2">
<h2 class="sect2">Characters with Special Meaning in XML<a id="sthref484" name="sthref484"></a><a id="sthref485" name="sthref485"></a></h2>
<p>The following characters in <a href="#BABDGBDA">Table 3-16</a> have special meaning in XML. For more information, refer to the XML 1.0 specifications</p>
<div class="tblformal"><a id="sthref486" name="sthref486"></a><a id="BABDGBDA" name="BABDGBDA"></a>
<p class="titleintable">Table 3-16 Characters with Special Meaning in XML</p>
<table class="Formal" title="Characters with Special Meaning in XML" summary="First column:special characters, second column: Meaning in XML, third column: entity encoding" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="28%" />
<col width="36%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t77">Character</th>
<th align="left" valign="bottom" id="r1c2-t77">Meaning in XML</th>
<th align="left" valign="bottom" id="r1c3-t77">Entity Encoding</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t77" headers="r1c1-t77">
<p>&lt;</p>
</td>
<td align="left" headers="r2c1-t77 r1c2-t77">
<p>Begins an XML tag</p>
</td>
<td align="left" headers="r2c1-t77 r1c3-t77">
<p>&amp;lt;</p>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t77" headers="r1c1-t77">
<p>&gt;</p>
</td>
<td align="left" headers="r3c1-t77 r1c2-t77">
<p>Ends an XML tag</p>
</td>
<td align="left" headers="r3c1-t77 r1c3-t77">
<p>&amp;gt;</p>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t77" headers="r1c1-t77">
<p>"</p>
</td>
<td align="left" headers="r4c1-t77 r1c2-t77">
<p>Quotation mark</p>
</td>
<td align="left" headers="r4c1-t77 r1c3-t77">
<p>&amp;quot;</p>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r5c1-t77" headers="r1c1-t77">
<p>'</p>
</td>
<td align="left" headers="r5c1-t77 r1c2-t77">
<p>Apostrophe or single quotation mark</p>
</td>
<td align="left" headers="r5c1-t77 r1c3-t77">
<p>&amp;apos;</p>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r6c1-t77" headers="r1c1-t77">
<p>&amp;</p>
</td>
<td align="left" headers="r6c1-t77 r1c2-t77">
<p>Ampersand</p>
</td>
<td align="left" headers="r6c1-t77 r1c3-t77">
<p>&amp;amp;</p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" -->
<p>When these characters appear as data in an XML element, they are replaced with their equivalent entity encoding.</p>
<p>Also certain characters are not valid in XML element names. When SQL identifiers (such as column names) are mapped to XML element names, these characters are converted to a sequence of hexadecimal digits, derived from the Unicode encoding of the character, bracketed by an introductory underscore, a lowercase <code>x</code> and a trailing underscore. A blank space is not a valid character in an XML element name. If a SQL identifier contains a space character, then in the corresponding XML element name, the space character is replaced by <code>_x0020_</code>, which is based on Unicode encoding of the space character.</p>
</div>
<!-- class="sect2" -->
<a id="i1013872" name="i1013872"></a>
<div class="sect2">
<h2 class="sect2">Retrieving Query Result Set as XML<a id="sthref487" name="sthref487"></a></h2>
<p>This section discusses retrieving the result set from a SQL query as XML data.</p>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref488" name="sthref488"></a>
<h3 class="sect3">Handling Date and Time Format<a id="sthref489" name="sthref489"></a></h3>
<p><a href="#CIHGCGJC">Table 3-17</a> lists the date and time format handling when retrieving data, for different database releases.</p>
<div class="tblformal"><a id="sthref490" name="sthref490"></a><a id="CIHGCGJC" name="CIHGCGJC"></a>
<p class="titleintable">Table 3-17 Date and Time Format Handling When Retrieving Data</p>
<table class="Formal" title="Date and Time Format Handling When Retrieving Data" summary="First column: Database release, second column: Date and Time format supported" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="31%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t78">Database Release</th>
<th align="left" valign="bottom" id="r1c2-t78">Date and Time Format Supported</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t78" headers="r1c1-t78">
<p>Oracle9<span class="italic">i</span> release 2 (9.2.<span class="italic">x</span>) and Oracle Database 10<span class="italic">g</span></p>
</td>
<td align="left" headers="r2c1-t78 r1c2-t78">
<p>Oracle <code>DATE</code> type data is retrieved in the format specified using the <code>NLS_DATE_FORMAT</code> in the session.</p>
<p><code>TIMESTAMP</code> and <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> type data is retrieved in the format specified using the <code>NLS_TIMESTAMP_FORMAT</code> and the <code>NLS_TIMESTAMP_TZ_FORMAT</code> in the session.</p>
<p>If the result XML document is used to save changes back to the database, then all <code>DATE</code> and <code>TIMESTAMP</code> data must be retrieved in the XML document as the following ISO Date and Time Format: <code>YYYY-MM-DDThh:mm:ss.sss</code> (ISO Format notation).</p>
<p>To do this, before the query is executed, the application must explicitly perform an <code>ALTER</code> <code>SESSION</code> statement on the session for the following NLS session parameters:</p>
<ul>
<li>
<p><code>NLS_DATE_FORMAT</code> - Must be set to the following Oracle Date and Time Format: <code>YYYY-MM-DD"T"HH24:MI:SS</code></p>
</li>
<li>
<p><code>NLS_TIMESTAMP_FORMAT</code> - Must be set to the following Oracle Date and Time Format: <code>YYYY-MM-DD"T"HH24:MI:SS.FF3</code></p>
</li>
<li>
<p><code>NLS_TIMESTAMP_TZ_FORMAT</code> - Must be set to the following Oracle Date and Time Format: <code>YYYY-MM-DD"T"HH24:MI:SS.FF3</code></p>
</li>
</ul>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t78" headers="r1c1-t78">
<p>Oracle Database 10<span class="italic">g</span> release 2 (10.2) or later</p>
</td>
<td align="left" headers="r3c1-t78 r1c2-t78">
<p>The generated XML <code>DATE</code> and <code>TIMESTAMP</code> formats are based on the standard XML Schema formats.</p>
<p>For more information on the XML Schema specification, see</p>
<p><code><a href="http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#isoformats">http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#isoformats</a></code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblformal" --></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref491" name="sthref491"></a>
<h3 class="sect3">Characters with Special Meaning in Column Data</h3>
<p>If the data in any of the select list columns in the query contains any characters with special meaning in XML (see <a href="#BABDGBDA">Table 3-16</a>), these characters are replaced with their corresponding entity encoding in the result XML document.</p>
<p>The following examples demonstrate how ODP.NET handles the angle bracket characters in the column data:</p>
<pre xml:space="preserve" class="oac_no_warn">/* Database Setup
connect scott/tiger@oracle
drop table specialchars;
create table specialchars ("id" number, name varchar2(255));
insert into specialchars values (1, '&lt;Jones&gt;');
commit;
*/
 
// C#
 
using System;
using System.Data;
using System.Xml;
using Oracle.DataAccess.Client; 
 
class QueryResultAsXMLSample
{
  static void Main()
  {
    OracleConnection con = new OracleConnection();
 
    con.ConnectionString = "User Id=scott;Password=tiger;Data Source=oracle;";
    con.Open();
 
    // Create the command
    OracleCommand cmd = new OracleCommand("", con);
 
    // Set the XML command type to query.
    cmd.XmlCommandType = OracleXmlCommandType.Query;
 
    // Set the SQL query
    cmd.CommandText = "select * from specialchars";
 
    // Set command properties that affect XML query behavior.
    cmd.BindByName = true;
 
    // Set the XML query properties
    cmd.XmlQueryProperties.MaxRows = -1;
 
    // Get the XML document as an XmlReader.
    XmlReader xmlReader = cmd.ExecuteXmlReader();
    XmlDocument xmlDocument = new XmlDocument();
 
    xmlDocument.PreserveWhitespace = true;
    xmlDocument.Load(xmlReader);
    Console.WriteLine(xmlDocument.OuterXml);
 
    // Close and Dispose OracleConnection object
    con.Close();
    con.Dispose();
  }
}
</pre>
<p>The following XML document is generated for that table: The XML entity encoding that represents the angle brackets appears in bold.</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
&lt;ROWSET&gt;
   &lt;ROW&gt;
      &lt;id&gt;1&lt;/id &gt;
      &lt;NAME&gt;<span class="bold">&amp;lt;</span>Jones<span class="bold">&amp;gt;</span>&lt;/NAME&gt;
   &lt;/ROW&gt;
&lt;/ROWSET&gt;
</pre></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref492" name="sthref492"></a>
<h3 class="sect3">Characters in Table or View Name</h3>
<p>If a table or view name has any non-alphanumeric characters other than an underscore (_), the table or view name must be enclosed in quotation marks.</p>
<p>For example, to select all entries from a table with the name <code>test'ing</code>, the <code>CommandText</code> property of the <code>OracleCommand</code> object must be set to the following string:</p>
<pre xml:space="preserve" class="oac_no_warn">"select * from \"test'ing\"";
</pre></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref493" name="sthref493"></a>
<h3 class="sect3">Case-Sensitivity in Column Name to XML Element Name Mapping</h3>
<p>The mapping of SQL identifiers (column names) to XML element names is case- sensitive, and the element names are in exactly the same case as the column names of the table or view.</p>
<p>However, the root tag and row tag names are case-insensitive. The following example demonstrates case-sensitivity in this situation:</p>
<pre xml:space="preserve" class="oac_no_warn">//Create the following table
create table casesensitive_table ("Id" number, NAME varchar2(255));
 
//insert name and id
insert into casesensitive_table values(1, 'Smith');
 
</pre>
<p>The following XML document is generated:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
  &lt;ROWSET&gt;
    &lt;ROW&gt;
      &lt;Id&gt;1&lt;/Id&gt;
      &lt;NAME&gt;Smith&lt;/NAME&gt;
    &lt;/ROW&gt;
  &lt;/ROWSET&gt;
</pre>
<p>Note that the element name for the <code>Id</code> column matches the case of the column name.</p>
</div>
<!-- class="sect3" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref494" name="sthref494"></a>
<h3 class="sect3">Column Name to XML Element Name Mapping</h3>
<p>For each row generated by the SQL query, the SQL identifier (column name) maps to an XML element in the generated XML document, as shown in the following example:</p>
<pre xml:space="preserve" class="oac_no_warn">// Create the following table
create table emp_table (EMPLOYEE_ID NUMBER(4), LAST_NAME varchar2(25));
// Insert some data
insert into emp_table values(205, 'Higgins');
</pre>
<p>The SQL query, <code>SELECT</code> <code>*</code> <code>FROM</code> <code>EMP_TABLE</code>, generates the following XML document:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?XML version="1.0"?&gt;
  &lt;ROWSET&gt;
    &lt;ROW&gt;
      &lt;EMPLOYEE_ID&gt;205&lt;/EMPLOYEE_ID&gt;
      &lt;LAST_NAME&gt;Higgins&lt;/LAST_NAME&gt;
    &lt;/ROW&gt;
  &lt;/ROWSET&gt;
</pre>
<p>The <code>EMPLOYEE_ID</code> and <code>LAST_NAME</code> database columns of the <code>employees</code> table map to the <code>EMPLOYEE_ID</code> and <code>LAST_NAME</code> elements of the generated XML document.</p>
<p>This section demonstrates how Oracle database handles the mapping of SQL identifiers to XML element names, when retrieving query results as XML from the database. The demonstration uses the <code>specialchars</code> table involving the <code>some</code> <code>id</code> column.</p>
<pre xml:space="preserve" class="oac_no_warn">// Create the specialchars table
create table specialchars ("some id" number, name varchar2(255));
</pre>
<p>Note that the <code>specialchars</code> table has a column named <code>some</code> <code>id</code> that contains a blank space character. The space character is not allowed in an XML element name.</p>
<p>When retrieving the query results as XML, the SQL identifiers in the query select list can contain characters that are not valid in XML element names. When these SQL identifiers (such as column names) are mapped to XML element names, each of these characters is converted to a sequence of hexadecimal digits, derived from the Unicode encoding of the characters, bracketed by an introductory underscore, a lowercase x, and a trailing underscore.</p>
<p>Thus, the SQL query in the following example can be used to get a result as an XML document from the <code>specialchars</code> table:</p>
<pre xml:space="preserve" class="oac_no_warn">select "some id", name from specialchars;
</pre>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a href="#i1015150">"Characters with Special Meaning in XML"</a></div>
<div class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref495" name="sthref495"></a>
<h4 class="sect4">Improving Default Mapping</h4>
<p>You can improve the default mapping of SQL identifiers to XML element names by using the following techniques:</p>
<ul>
<li>
<p>Modify the source. Create an object-relational view over the source schema, and make that view the new source.</p>
</li>
<li>
<p>Use cursor subqueries and cast-multiset constructs in the SQL query.</p>
</li>
<li>
<p>Create an alias for the column or attribute names in the SQL query. Prefix the aliases with an at sign (@) to map them to XML attributes instead of XML elements.</p>
</li>
<li>
<p>Modify the XML document. Use <a href="glossary.htm#CBADGHEG"><span class="xrefglossterm">Extensible Stylesheet Language Transformation (XSLT)</span></a> to transform the XML document. Specify the XSL document and parameters. The transformation is done automatically after the XML document is generated from the relational data. Note that this may have an impact on performance.</p>
</li>
<li>
<p>Specify the name of the root tag and row tag used in the XML document.</p>
</li>
</ul>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref496" name="sthref496"></a>
<h3 class="sect3">Object-Relational Data<a id="sthref497" name="sthref497"></a></h3>
<p>ODP.NET can generate an XML document for data stored in object-relational columns, tables, and views, as shown in the following example:</p>
<pre xml:space="preserve" class="oac_no_warn">// Create the following tables and types
CREATE TYPE "EmployeeType" AS OBJECT (EMPNO NUMBER, ENAME VARCHAR2(20));
/
CREATE TYPE EmployeeListType AS TABLE OF "EmployeeType";
/
CREATE TABLE mydept (DEPTNO NUMBER, DEPTNAME VARCHAR2(20), 
              EMPLIST EmployeeListType)
              NESTED TABLE EMPLIST STORE AS EMPLIST_TABLE;
INSERT INTO mydept VALUES (1, 'depta',
              EmployeeListType("EmployeeType"(1, 'empa')));
</pre>
<p>The following XML document is generated for the table:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = "1.0"?&gt;
&lt;ROWSET&gt;
   &lt;ROW&gt;
      &lt;DEPTNO&gt;1&lt;/DEPTNO&gt;
      &lt;DEPTNAME&gt;depta&lt;/DEPTNAME&gt;
      &lt;EMPLIST&gt;
         &lt;<span class="bold">EmployeeType</span>&gt;
            &lt;EMPNO&gt;1&lt;/EMPNO&gt;
            &lt;ENAME&gt;empa&lt;/ENAME&gt;
         &lt;/<span class="bold">EmployeeType</span>&gt;
      &lt;/EMPLIST&gt;
   &lt;/ROW&gt;
&lt;/ROWSET&gt;
</pre>
<p>ODP.NET encloses each item in a collection element, with the database type name of the element in the collection. The <code>mydept</code> table has a collection in the <code>EMPLIST</code> database column and each item in the collection is of type <code>EmployeeType</code>. Therefore, in the XML document, each item in the collection is enclosed in the type name <code>EmployeeType</code>, which appears in bold in the example.</p>
</div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref498" name="sthref498"></a>
<h3 class="sect3">NULL Values<a id="sthref499" name="sthref499"></a></h3>
<p>If any database row has a column with a <code>NULL</code> value, then that column does not appear for that row in the generated XML document.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" -->
<a id="i1012662" name="i1012662"></a>
<div class="sect2">
<h2 class="sect2">Data Manipulation Using XML<a id="sthref500" name="sthref500"></a><a id="sthref501" name="sthref501"></a><a id="sthref502" name="sthref502"></a></h2>
<p>This section discusses making changes to the database data using XML.</p>
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref503" name="sthref503"></a>
<h3 class="sect3">Handling Date and Time Format<a id="sthref504" name="sthref504"></a><a id="sthref505" name="sthref505"></a><a id="sthref506" name="sthref506"></a></h3>
<p><a href="#CIHCJHBG">Table 3-18</a> lists the date and time format handling when saving data, for different database releases.</p>
<div class="tblhruleformal"><a id="sthref507" name="sthref507"></a><a id="CIHCJHBG" name="CIHCJHBG"></a>
<p class="titleintable">Table 3-18 Date and Time Format Handling When Saving Data</p>
<table class="HRuleFormal" title="Date and Time Format Handling When Saving Data" summary="First column: Database release, second column: Date and Time format supported" dir="ltr" border="1" width="100%" frame="hsides" rules="rows" cellpadding="3" cellspacing="0">
<col width="31%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t80">Database Release</th>
<th align="left" valign="bottom" id="r1c2-t80">Date and Time Format Supported</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t80" headers="r1c1-t80">
<p>Oracle9<span class="italic">i</span> release 2 (9.2.x) and Oracle Database 10<span class="italic">g</span></p>
</td>
<td align="left" headers="r2c1-t80 r1c2-t80">
<p>All <code>DATE</code>, <code>TIMESTAMP</code>, and <code>TIMESTAMP</code> <code>WITH</code> <code>TIME</code> <code>ZONE</code> type data must be specified in the XML document in the ISO Date and Time Format <code>YYYY-MM-DDThh:mm:ss.sss</code> (ISO Format notation).</p>
<p>The following string is the ISO Date and Time Format notation represented in the Oracle Date and Time Format notation: <code>YYYY-MM-DD"T"HH24:MI:SS.FF3</code>.</p>
<p>In addition to using the ISO Format notation in the XML document, before the save is executed, the application must explicitly perform an <code>ALTER</code> <code>SESSION</code> command on the session for the following NLS session parameters:</p>
<ul>
<li>
<p><code>NLS_DATE_FORMAT</code> - Must be set to the following Oracle Date and Time Format: <code>YYYY-MM-DD"T"HH24:MI:SS</code></p>
</li>
<li>
<p><code>NLS_TIMESTAMP_FORMAT</code> - Must be set to the following Oracle Date and Time Format: <code>YYYY-MM-DD"T"HH24:MI:SS.FF3</code></p>
</li>
<li>
<p><code>NLS_TIMESTAMP_TZ_FORMAT</code> - Must be set to the following Oracle Date and Time Format: <code>YYYY-MM-DD"T"HH24:MI:SS.FF3</code></p>
</li>
</ul>
</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t80" headers="r1c1-t80">
<p>Oracle Database 10<span class="italic">g</span> release 2 (10.2) or later</p>
</td>
<td align="left" headers="r3c1-t80 r1c2-t80">
<p>The generated XML <code>DATE</code> and <code>TIMESTAMP</code> formats are based on the standard XML Schema formats.</p>
<p>For more information on the XML Schema specification, see</p>
<p><code><a href="http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#isoformats">http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#isoformats</a></code></p>
</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="tblhruleformal" --></div>
<!-- class="sect3" -->
<div class="sect3"><!-- infolevel="all" infotype="General" --><a id="sthref508" name="sthref508"></a>
<h3 class="sect3">Saving Changes Using XML<a id="sthref509" name="sthref509"></a><a id="sthref510" name="sthref510"></a></h3>
<p>Changes can be saved to database tables and views using XML data. However, insert, update, and delete operations cannot be combined in a single XML document. ODP.NET cannot accept a single XML document and determine which are insert, update, or delete changes.</p>
<p>The insert change must be in an XML document containing only rows to be inserted, the update changes only with rows to be updated, and the delete changes only with rows to be deleted.</p>
<p>For example, using the <code>employees</code> table that comes with the HR sample schema, you can specify the following query:</p>
<pre xml:space="preserve" class="oac_no_warn">select employee_id, last_name from employees where employee_id = 205;
</pre>
<p>The following XML document is generated:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
&lt;ROWSET&gt;
   &lt;ROW&gt;
      &lt;EMPLOYEE_ID&gt;205&lt;/EMPLOYEE_ID&gt;
      &lt;LAST_NAME&gt;<span class="bold">Higgins</span>&lt;/LAST_NAME&gt;
   &lt;/ROW&gt;
&lt;/ROWSET&gt;
</pre>
<p>To change the name of employee <code>205</code> from <code><span class="codeinlinebold">Higgins</span></code> to <code><span class="codeinlinebold">Smith</span></code>, specify the <code>employees</code> table and the XML data containing the changes as follows:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
&lt;ROWSET&gt;
   &lt;ROW&gt;
      &lt;EMPLOYEE_ID&gt;205&lt;/EMPLOYEE_ID&gt;
      &lt;LAST_NAME&gt;<span class="bold">Smith</span>&lt;/LAST_NAME&gt;
   &lt;/ROW&gt;
&lt;/ROWSET&gt;
</pre></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref511" name="sthref511"></a>
<h3 class="sect3">Characters with Special Meaning in Column Data<a id="sthref512" name="sthref512"></a><a id="sthref513" name="sthref513"></a></h3>
<p>If the data in any of the elements in the XML document contains characters that have a special meaning in XML (see <a href="#BABDGBDA">Table 3-16</a>), these characters must be replaced with appropriate entity encoding, or be preceded by an escape character in the XML document, so that the data is stored correctly in the database table column. Otherwise, ODP.NET throws an exception.</p>
<p>The following example demonstrates how ODP.NET handles the angle bracket special characters in the column data, using entity encoding:</p>
<pre xml:space="preserve" class="oac_no_warn">// Create the following table
create table specialchars ("id" number, name varchar2(255));
</pre>
<p>The following XML document can be used to insert values <code>(1,</code> <code>'&lt;Jones&gt;')</code> into the <code>specialchars</code> table. The XML entity encoding that represents the angle brackets appears in bold.</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
 &lt;ROWSET&gt;
  &lt;ROW&gt;
   &lt;id&gt;1&lt;/id &gt;
   &lt;NAME&gt;<span class="bold">&amp;lt;</span>Jones<span class="bold">&amp;gt;</span>&lt;/NAME&gt;
  &lt;/ROW&gt;
 &lt;/ROWSET&gt;
</pre></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref514" name="sthref514"></a>
<h3 class="sect3">Characters with Special Meaning in Table or View Name<a id="sthref515" name="sthref515"></a><a id="sthref516" name="sthref516"></a></h3>
<p>If a table or view name has any non-alphanumeric characters other than an underscore (_), the table or view name must be enclosed in quotation marks.</p>
<p>For example, to save changes to a table with the name <code>test'ing</code>, the <code>OracleCommand.XmlSaveProperties.TableName</code> property must be set to <code>"\"test'ing\""</code>.</p>
</div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref517" name="sthref517"></a>
<h3 class="sect3">Case-Sensitivity in XML Element Name to Column Name Mapping<a id="sthref518" name="sthref518"></a><a id="sthref519" name="sthref519"></a></h3>
<p>For each XML element that represents a row of data in the XML document, the child XML elements map to database column names. The mapping of the child element name to the column name is always case-sensitive, but the root tag and row tag names are case-insensitive. The following example demonstrates this case-sensitivity:</p>
<pre xml:space="preserve" class="oac_no_warn">//Create the following table
create table casesensitive_table ("Id" number, NAME varchar2(255));
</pre>
<p>The following XML document can be used to insert values (<code>1</code>, <code>Smith</code>) into the <code>casesensitive_table</code>:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
  &lt;ROWSET&gt;
    &lt;ROW&gt;
      &lt;Id&gt;1&lt;/Id&gt;
      &lt;NAME&gt;Smith&lt;/NAME&gt;
    &lt;/ROW&gt;
  &lt;/ROWSET&gt;
</pre>
<p>Note that the element name for the <code>Id</code> column matches the case of the column name.</p>
</div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref520" name="sthref520"></a>
<h3 class="sect3">XML Element Name to Column Name Mapping<a id="sthref521" name="sthref521"></a></h3>
<p>This section describes how Oracle database handles the mapping of XML element names to column names when using XML for data manipulation in the database. The following <code>specialchars</code> table involving the <code>some</code> <code>id</code> column demonstrates this handling.</p>
<pre xml:space="preserve" class="oac_no_warn">// Create the specialchars table
create table specialchars ("some id" number, name varchar2(255));
</pre>
<p>Note that the <code>specialchars</code> table has a column named <code>some</code> <code>id</code> that contains a blank space character. The space character is not allowed in an XML element name.</p>
</div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref522" name="sthref522"></a>
<h3 class="sect3">Saving Changes to a Table Using an XML Document <a id="sthref523" name="sthref523"></a></h3>
<p>When an XML document is used to save changes to a table or view, the <code>OracleCommand.XmlSaveProperties.UpdateColumnsList</code> property is used to specify the list of columns to update or insert.</p>
<p>When an XML document is used to save changes to a column in a table or view, and the corresponding column name contains any of the characters that are not valid in an XML element name, the escaped column name must be specified in the <code>UpdateColumnsList</code> property as in the following example.</p>
<p>The following XML document can be used to insert values (<code>2</code>, <code>&lt;Jones&gt;</code>) into the <code>specialchars</code> table:</p>
<pre xml:space="preserve" class="oac_no_warn">&lt;?xml version = '1.0'?&gt;
  &lt;ROWSET&gt;
    &lt;ROW&gt;
      &lt;some_x0020_id&gt;2&lt;/some_x0020_id&gt;
      &lt;NAME&gt;&amp;lt;Jones&amp;gt;&lt;/NAME&gt;
    &lt;/ROW&gt;
  &lt;/ROWSET&gt;
</pre>
<p>The following example specifies the list of columns to update or insert:</p>
<pre xml:space="preserve" class="oac_no_warn">/* Database Setup
connect scott/tiger@oracle
drop table specialchars;
create table specialchars ("some id" number, name varchar2(255));
insert into specialchars values (1, '&lt;Jones&gt;');
commit;
*/
 
// C#
 
using System;
using System.Data;
using System.Xml;
using Oracle.DataAccess.Client; 
 
class InsertUsingXmlDocSample
{
  static void Main()
  {
    OracleConnection con = new OracleConnection();
 
    con.ConnectionString = "User Id=scott;Password=tiger;Data Source=oracle;";
    con.Open();
    Console.WriteLine("Connected Successfully");
 
    // Create the command
    OracleCommand cmd = new OracleCommand("", con);
 
    // Set the XML command type to query.
    cmd.XmlCommandType = OracleXmlCommandType.Insert;
 
    // Set the XML document
    cmd.CommandText = "&lt;?xml version = '1.0'?&gt;\n" + "&lt;ROWSET&gt;\n" + "&lt;ROW&gt;\n" +
      "&lt;some_x0020_id&gt;2&lt;/some_x0020_id&gt;\n" + "&lt;NAME&gt;&amp;lt;Jones&amp;gt;&lt;/NAME&gt;\n" + 
      "&lt;/ROW&gt;\n" + "&lt;/ROWSET&gt;\n";
    cmd.XmlSaveProperties.Table = "specialchars";
 
    string[] ucols = new string[2];
 
    ucols[0] = "some_x0020_id";
    ucols[1] = "NAME";
    cmd.XmlSaveProperties.UpdateColumnsList = ucols;
 
    // Insert rows
    int rows = cmd.ExecuteNonQuery();
 
    Console.WriteLine("Number of rows inserted successfully : {0} ", rows);
 
    // Close and Dispose OracleConnection object
    con.Close();
    con.Dispose();
  }
}
</pre>
<div class="sect4"><!-- infolevel="all" infotype="General" --><a id="sthref524" name="sthref524"></a>
<h4 class="sect4">Improving Default Mapping<a id="sthref525" name="sthref525"></a><a id="sthref526" name="sthref526"></a></h4>
<p>You can improve the default mapping by using the following techniques:</p>
<ul>
<li>
<p>Modify the target. Create an object-relational view over the target schema, and make the view the new target.</p>
</li>
<li>
<p>Modify the XML document. Use XSLT to transform the XML document. Specify the XSL document and parameters. The transformation is done before the changes are saved. Note that this is may have an impact on performance.</p>
</li>
<li>
<p>Specify the name of the row tag used in the XML document.</p>
</li>
</ul>
</div>
<!-- class="sect4" --></div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref527" name="sthref527"></a>
<h3 class="sect3">Object-Relational Data<a id="sthref528" name="sthref528"></a></h3>
<p>Changes in an XML document can also be saved to object-relational data. Each item in a collection can be specified in one of the following ways in the XML document:</p>
<ul>
<li>
<p>By enclosing the database type name of the item as the XML element name.</p>
</li>
<li>
<p>By enclosing the name of the database column holding the collection with <code>_ITEM</code> appended as the XML element name.</p>
</li>
</ul>
</div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref529" name="sthref529"></a>
<h3 class="sect3">Multiple Tables<a id="sthref530" name="sthref530"></a></h3>
<p>Oracle Database does not save changes to multiple relational tables that have been joined together. Oracle recommends that you create a view on those relational tables, and then update that view. If the view cannot be updated, triggers can be used instead.</p>
<div class="infoboxnotealso">
<p class="notep1">See Also:</p>
<a class="olink SQLRF01103" href="http://www.oracle.com/pls/db102/lookup?id=SQLRF01103"><span class="italic">Oracle Database SQL Reference</span></a> for the description and syntax of the <code>CREATE</code> <code>VIEW</code> statement</div>
</div>
<!-- class="sect3" -->
<div class="sect3"><a id="sthref531" name="sthref531"></a>
<h3 class="sect3">Commit <a id="sthref532" name="sthref532"></a><a id="sthref533" name="sthref533"></a>Transactions</h3>
<p>When the changes in an XML document are made, either all the changes are committed, or if an error occurs, all changes are rolled back.</p>
</div>
<!-- class="sect3" --></div>
<!-- class="sect2" --></div>
<!-- class="sect1" --></div>
<!-- class="ind" -->
<div class="footer">
<hr />
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="100%">
<col width="33%" />
<col width="*" />
<col width="33%" />
<tr>
<td align="left">
<table class="simple oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="98">
<tr>
<td align="center" valign="top"><a href="featLOBsupp.htm"><img width="24" height="24" src="../../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td align="center" valign="top"><a href="featUDTs.htm"><img width="24" height="24" src="../../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td style="font-size: 90%" align="center" class="copyrightlogo"><img width="144" height="18" src="../../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;2002, 2010,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td align="right">
<table class="icons oac_no_warn" summary="" cellspacing="0" cellpadding="0" width="245">
<tr>
<td align="center" valign="top"><a href="../../index.htm"><img width="24" height="24" src="../../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td align="center" valign="top"><a href="../../nav/portal_booklist.htm"><img width="24" height="24" src="../../dcommon/gifs/booklist.gif" alt="Go to Book List" /><br />
<span class="icon">Book List</span></a></td>
<td align="center" valign="top"><a href="toc.htm"><img width="24" height="24" src="../../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td align="center" valign="top"><a href="index.htm"><img width="24" height="24" src="../../dcommon/gifs/index.gif" alt="Go to Index" /><br />
<span class="icon">Index</span></a></td>
<td align="center" valign="top"><a href="../../dcommon/html/feedback.htm"><img width="24" height="24" src="../../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
